episode 0
Simulating
Action Durations at step 0: [54.72163391113281, 42.903499603271484, 56.5316276550293, 19.217578887939453]
Traffic light set to phase 0 for 54.72163391113281 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 42.903499603271484 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 56.5316276550293 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 19.217578887939453 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 1
Action Durations at step 215: [24.3653564453125, 17.20758056640625, 50.221736907958984, 51.491966247558594]
Traffic light set to phase 0 for 24.3653564453125 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 17.20758056640625 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 50.221736907958984 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 51.491966247558594 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 2
Action Durations at step 401: [36.50508499145508, 52.62284851074219, 45.09946060180664, 48.9434814453125]
Traffic light set to phase 0 for 36.50508499145508 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 52.62284851074219 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 45.09946060180664 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 48.9434814453125 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 3
Action Durations at step 626: [33.859214782714844, 18.527233123779297, 20.45119857788086, 20.370296478271484]
Traffic light set to phase 0 for 33.859214782714844 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 18.527233123779297 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 20.45119857788086 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 20.370296478271484 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 4
Action Durations at step 761: [35.502357482910156, 20.89382553100586, 13.9849214553833, 24.74072265625]
Traffic light set to phase 0 for 35.502357482910156 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 20.89382553100586 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 13.9849214553833 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 24.74072265625 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 5
Action Durations at step 897: [58.590091705322266, 30.232643127441406, 54.70304870605469, 54.11964416503906]
Traffic light set to phase 0 for 58.590091705322266 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 30.232643127441406 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 54.70304870605469 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 54.11964416503906 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 6
Action Durations at step 1137: [35.831932067871094, 17.764726638793945, 33.75439453125, 8.098363876342773]
Traffic light set to phase 0 for 35.831932067871094 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 17.764726638793945 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 33.75439453125 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 8.098363876342773 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 7
Action Durations at step 1274: [36.868385314941406, 6.443809509277344, 13.062823295593262, 53.28104019165039]
Traffic light set to phase 0 for 36.868385314941406 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 6.443809509277344 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 13.062823295593262 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 53.28104019165039 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 8
Action Durations at step 1426: [19.751419067382812, 23.84771728515625, 51.251094818115234, 40.906471252441406]
Traffic light set to phase 0 for 19.751419067382812 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 23.84771728515625 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 51.251094818115234 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 40.906471252441406 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 9
Action Durations at step 1603: [5.2340545654296875, 25.77724838256836, 8.152908325195312, 57.102298736572266]
Traffic light set to phase 0 for 5.2340545654296875 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 25.77724838256836 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 8.152908325195312 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 57.102298736572266 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 10
Action Durations at step 1742: [29.290544509887695, 47.54378890991211, 22.352956771850586, 5.396233081817627]
Traffic light set to phase 0 for 29.290544509887695 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 47.54378890991211 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 22.352956771850586 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 5.396233081817627 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 11
Action Durations at step 1889: [13.808246612548828, 25.039461135864258, 6.330142021179199, 43.238800048828125]
Traffic light set to phase 0 for 13.808246612548828 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 25.039461135864258 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 6.330142021179199 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 43.238800048828125 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 12
Action Durations at step 2020: [23.815326690673828, 50.83537292480469, 12.628805160522461, 26.693527221679688]
Traffic light set to phase 0 for 23.815326690673828 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 50.83537292480469 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 12.628805160522461 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 26.693527221679688 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 13
Action Durations at step 2175: [52.11241149902344, 34.674415588378906, 55.66183853149414, 37.85365676879883]
Traffic light set to phase 0 for 52.11241149902344 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 34.674415588378906 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 55.66183853149414 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 37.85365676879883 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 14
Action Durations at step 2397: [28.956588745117188, 58.476722717285156, 10.14864730834961, 6.018308162689209]
Traffic light set to phase 0 for 28.956588745117188 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 58.476722717285156 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 10.14864730834961 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 6.018308162689209 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 15
Action Durations at step 2543: [39.054134368896484, 24.358055114746094, 57.40363311767578, 6.787957191467285]
Traffic light set to phase 0 for 39.054134368896484 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 24.358055114746094 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 57.40363311767578 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 6.787957191467285 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 16
Action Durations at step 2713: [59.83243179321289, 18.260101318359375, 57.19538497924805, 30.370555877685547]
Traffic light set to phase 0 for 59.83243179321289 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 18.260101318359375 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 57.19538497924805 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 30.370555877685547 seconds.
Traffic light set to phase 7 for 10 seconds.
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 87, in <module>
    Simulation.run(episode,epsilon)
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 199, in run
    self.optimize_model()
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 303, in optimize_model
    action_q_values = current_q_values.gather(1, action_batch.unsqueeze(-1)).squeeze(-1)
RuntimeError: Index tensor must have the same number of dimensions as input tensor