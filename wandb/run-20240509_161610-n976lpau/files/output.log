episode 0
Simulating
Action Durations at step 0: tensor([30.4762, 47.9439, 17.5505, 14.3174])
Traffic light set to phase 0 for 30.476234436035156 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 47.943912506103516 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 17.55051040649414 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 14.317376136779785 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 1
Action Durations at step 152: tensor([51.6745,  6.5686,  8.2454, 34.7638])
Traffic light set to phase 0 for 51.67449951171875 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 6.568556785583496 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 8.245381355285645 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 34.76383590698242 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 2
Action Durations at step 295: tensor([45.0010, 10.9044, 45.4611, 10.8089])
Traffic light set to phase 0 for 45.00102996826172 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 10.904449462890625 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 45.46113204956055 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 10.808911323547363 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 3
Action Durations at step 449: tensor([36.8145, 17.9489, 20.2211,  5.7667])
Traffic light set to phase 0 for 36.81449508666992 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 17.948902130126953 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 20.221094131469727 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 5.7667412757873535 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 4
Action Durations at step 571: tensor([56.8165, 39.8350, 16.9532, 37.4967])
Traffic light set to phase 0 for 56.81645584106445 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 39.83502960205078 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 16.953214645385742 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 37.496734619140625 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 5
Action Durations at step 763: tensor([25.7905, 17.3973, 58.8834, 32.8364])
Traffic light set to phase 0 for 25.79053497314453 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 17.397258758544922 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 58.883445739746094 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 32.83644485473633 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 6
Action Durations at step 939: tensor([33.8221, 52.6016,  6.9467, 18.3483])
Traffic light set to phase 0 for 33.82206726074219 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 52.60157775878906 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 6.946693420410156 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 18.34832000732422 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 7
Action Durations at step 1092: tensor([ 6.6896, 14.5566, 43.6807, 35.3161])
Traffic light set to phase 0 for 6.68962287902832 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 14.556587219238281 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 43.68069839477539 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 35.31607437133789 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 8
Action Durations at step 1234: tensor([50.3942, 10.3253, 32.9757, 31.0743])
Traffic light set to phase 0 for 50.39420700073242 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 10.325348854064941 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 32.9757080078125 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 31.0743350982666 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 9
Action Durations at step 1401: tensor([33.7495, 54.1214, 38.7872, 57.4705])
Traffic light set to phase 0 for 33.74950408935547 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 54.121368408203125 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 38.78723907470703 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 57.47047424316406 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 10
Action Durations at step 1627: tensor([58.2365, 50.3002, 38.1862, 14.6366])
Traffic light set to phase 0 for 58.236480712890625 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 50.30021667480469 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 38.18617630004883 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 14.636645317077637 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 11
Action Durations at step 1831: tensor([37.9546, 22.0730, 25.7767, 27.1328])
Traffic light set to phase 0 for 37.954566955566406 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 22.073040008544922 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 25.776674270629883 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 27.13283348083496 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 12
Action Durations at step 1986: tensor([39.2871, 48.8360, 34.6807, 56.9105])
Traffic light set to phase 0 for 39.287147521972656 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 48.83599090576172 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 34.6806755065918 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 56.91046905517578 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 13
Action Durations at step 2207: tensor([46.8403, 56.8325, 43.2083, 19.1714])
Traffic light set to phase 0 for 46.84027099609375 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 56.832496643066406 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 43.20832824707031 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 19.17142677307129 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 14
Action Durations at step 2415: tensor([32.7889, 57.6002, 40.6709, 34.1251])
Traffic light set to phase 0 for 32.78889465332031 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 57.60018539428711 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 40.67092514038086 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 34.12512969970703 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 15
Action Durations at step 2622: tensor([35.8586, 23.7879, 36.6210, 15.8216])
Traffic light set to phase 0 for 35.85856246948242 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 23.78788948059082 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 36.62100601196289 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 15.821586608886719 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 16
Action Durations at step 2775: tensor([20.5985, 37.4165, 50.1402, 55.7861])
Traffic light set to phase 0 for 20.59848403930664 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 37.416507720947266 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 50.140220642089844 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 55.7861328125 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 17
Action Durations at step 2981: tensor([ 5.9885, 59.6470, 11.0328, 23.9047])
Traffic light set to phase 0 for 5.988459587097168 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 59.6469841003418 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 11.03280258178711 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 23.904735565185547 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 18
Action Durations at step 3123: tensor([31.7937, 33.7056, 46.4346, 28.2980])
Traffic light set to phase 0 for 31.79365348815918 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 33.7055778503418 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 46.434600830078125 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 28.29802703857422 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 19
Action Durations at step 3305: tensor([33.9731, 57.4573, 44.6353, 36.1280])
Traffic light set to phase 0 for 33.97314453125 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 57.45732116699219 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 44.63534927368164 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 36.12797927856445 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 20
Action Durations at step 3519: tensor([ 5.3899, 45.3435, 14.4396, 18.2567])
Traffic light set to phase 0 for 5.389928817749023 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 45.34347152709961 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 14.439553260803223 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 18.256694793701172 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences
No loss recorded for episode 0
epsilon : 1.000
queue length in epsiode 0 0.03786008230452675
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 89, in <module>
    print(f'loss in epsiode {episode}',Simulation.loss_store[episode])
IndexError: list index out of range