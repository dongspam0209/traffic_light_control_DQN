
episode 0
Simulating
Action Durations at step 0: [10.888494491577148, 11.919807434082031, 57.81948471069336, 19.169994354248047]
Traffic light set to phase 0 for 10.888494491577148 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 11.919807434082031 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 57.81948471069336 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 19.169994354248047 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 1
Action Durations at step 141: [58.680423736572266, 51.83926010131836, 59.744483947753906, 29.63229751586914]
Traffic light set to phase 0 for 58.680423736572266 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 51.83926010131836 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 59.744483947753906 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 29.63229751586914 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 2
Action Durations at step 382: [31.311979293823242, 40.9815788269043, 57.14740753173828, 37.0602912902832]
Traffic light set to phase 0 for 31.311979293823242 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 40.9815788269043 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 57.14740753173828 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 37.0602912902832 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 3
Action Durations at step 591: [32.11431121826172, 29.996339797973633, 49.134647369384766, 7.296568870544434]
Traffic light set to phase 0 for 32.11431121826172 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 29.996339797973633 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 49.134647369384766 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 7.296568870544434 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 4
Action Durations at step 752: [48.17087936401367, 23.317157745361328, 44.77581024169922, 58.48456573486328]
Traffic light set to phase 0 for 48.17087936401367 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 23.317157745361328 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 44.77581024169922 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 58.48456573486328 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 5
Action Durations at step 969: [53.86290740966797, 49.61286926269531, 51.55583953857422, 33.82245635986328]
Traffic light set to phase 0 for 53.86290740966797 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 49.61286926269531 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 51.55583953857422 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 33.82245635986328 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 6
Action Durations at step 1199: [54.21451950073242, 55.618858337402344, 50.909996032714844, 19.22499656677246]
Traffic light set to phase 0 for 54.21451950073242 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 55.618858337402344 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 50.909996032714844 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 19.22499656677246 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 7
Action Durations at step 1421: [55.582984924316406, 22.09868812561035, 41.8095703125, 55.558013916015625]
Traffic light set to phase 0 for 55.582984924316406 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 22.09868812561035 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 41.8095703125 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 55.558013916015625 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 8
Action Durations at step 1638: [23.3221435546875, 13.769553184509277, 54.15348815917969, 38.43247985839844]
Traffic light set to phase 0 for 23.3221435546875 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 13.769553184509277 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 54.15348815917969 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 38.43247985839844 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 9
Action Durations at step 1810: [22.60414695739746, 41.99441146850586, 52.26792526245117, 32.09342956542969]
Traffic light set to phase 0 for 22.60414695739746 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 41.99441146850586 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 52.26792526245117 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 32.09342956542969 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 10
Action Durations at step 2001: [18.252422332763672, 35.94230270385742, 46.55301284790039, 37.738548278808594]
Traffic light set to phase 0 for 18.252422332763672 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 35.94230270385742 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 46.55301284790039 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 37.738548278808594 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 11
Action Durations at step 2181: [23.673513412475586, 27.319896697998047, 26.644664764404297, 16.83840560913086]
Traffic light set to phase 0 for 23.673513412475586 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 27.319896697998047 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 26.644664764404297 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 16.83840560913086 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 12
Action Durations at step 2317: [58.88057327270508, 51.940277099609375, 11.112592697143555, 44.14614486694336]
Traffic light set to phase 0 for 58.88057327270508 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 51.940277099609375 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 11.112592697143555 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 44.14614486694336 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 13
Action Durations at step 2525: [45.205108642578125, 32.080726623535156, 41.01292037963867, 23.194307327270508]
Traffic light set to phase 0 for 45.205108642578125 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 32.080726623535156 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 41.01292037963867 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 23.194307327270508 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 14
Action Durations at step 2710: [47.10197448730469, 10.602266311645508, 5.4766058921813965, 7.66920804977417]
Traffic light set to phase 0 for 47.10197448730469 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 10.602266311645508 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 5.4766058921813965 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 7.66920804977417 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 15
Action Durations at step 2823: [31.62441635131836, 19.513151168823242, 26.313085556030273, 12.061729431152344]
Traffic light set to phase 0 for 31.62441635131836 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 19.513151168823242 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 26.313085556030273 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 12.061729431152344 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 16
Action Durations at step 2955: [17.24453353881836, 42.55233383178711, 13.294182777404785, 26.51408576965332]
Traffic light set to phase 0 for 17.24453353881836 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 42.55233383178711 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 13.294182777404785 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 26.51408576965332 seconds.
Traffic light set to phase 7 for 10 seconds.
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 87, in <module>
    Simulation.run(episode,epsilon)
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 199, in run
    self.optimize_model()
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 306, in optimize_model
    action_q_values = current_q_values.gather(1, action_batch).mean(dim=1)  # 각 배치마다 액션 인덱스를 사용하여 Q 값을 추출하고 평균 계산
RuntimeError: gather(): Expected dtype int64 for index