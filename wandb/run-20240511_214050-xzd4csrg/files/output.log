
episode 0
Simulating
Action Durations at step 0: [25.04966926574707, 47.168182373046875, 50.483821868896484, 14.108989715576172]
Traffic light set to phase 0 for 25.04966926574707 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 47.168182373046875 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 50.483821868896484 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 14.108989715576172 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 1
Action Durations at step 180: [29.81296157836914, 6.35269021987915, 49.71630859375, 43.5119743347168]
Traffic light set to phase 0 for 29.81296157836914 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 6.35269021987915 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 49.71630859375 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 43.5119743347168 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 2
Action Durations at step 351: [41.87375259399414, 39.07284164428711, 14.278924942016602, 55.881046295166016]
Traffic light set to phase 0 for 41.87375259399414 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 39.07284164428711 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 14.278924942016602 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 55.881046295166016 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 3
Action Durations at step 544: [38.796058654785156, 42.3379020690918, 30.278589248657227, 55.64371109008789]
Traffic light set to phase 0 for 38.796058654785156 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 42.3379020690918 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 30.278589248657227 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 55.64371109008789 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 4
Action Durations at step 753: [5.715885639190674, 39.26945495605469, 58.82943344116211, 26.49751091003418]
Traffic light set to phase 0 for 5.715885639190674 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 39.26945495605469 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 58.82943344116211 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 26.49751091003418 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 5
Action Durations at step 925: [27.803558349609375, 59.7766227722168, 33.644874572753906, 8.64561653137207]
Traffic light set to phase 0 for 27.803558349609375 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 59.7766227722168 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 33.644874572753906 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 8.64561653137207 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 6
Action Durations at step 1096: [17.502796173095703, 31.362445831298828, 12.813846588134766, 22.478029251098633]
Traffic light set to phase 0 for 17.502796173095703 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 31.362445831298828 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 12.813846588134766 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 22.478029251098633 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 7
Action Durations at step 1222: [38.40513610839844, 28.02098846435547, 33.133705139160156, 28.147462844848633]
Traffic light set to phase 0 for 38.40513610839844 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 28.02098846435547 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 33.133705139160156 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 28.147462844848633 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 8
Action Durations at step 1393: [15.238178253173828, 13.658554077148438, 45.928810119628906, 41.66426467895508]
Traffic light set to phase 0 for 15.238178253173828 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 13.658554077148438 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 45.928810119628906 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 41.66426467895508 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 9
Action Durations at step 1551: [17.539140701293945, 9.555765151977539, 31.63310432434082, 53.34913635253906]
Traffic light set to phase 0 for 17.539140701293945 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 9.555765151977539 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 31.63310432434082 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 53.34913635253906 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 10
Action Durations at step 1705: [33.85981750488281, 12.651159286499023, 43.83032989501953, 17.96217918395996]
Traffic light set to phase 0 for 33.85981750488281 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 12.651159286499023 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 43.83032989501953 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 17.96217918395996 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 11
Action Durations at step 1854: [47.6462287902832, 52.58984375, 54.94099426269531, 54.074485778808594]
Traffic light set to phase 0 for 47.6462287902832 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 52.58984375 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 54.94099426269531 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 54.074485778808594 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 12
Action Durations at step 2105: [20.875394821166992, 36.20512771606445, 42.97888946533203, 9.598451614379883]
Traffic light set to phase 0 for 20.875394821166992 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 36.20512771606445 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 42.97888946533203 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 9.598451614379883 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 13
Action Durations at step 2256: [40.05738067626953, 13.814894676208496, 10.428122520446777, 44.060821533203125]
Traffic light set to phase 0 for 40.05738067626953 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 13.814894676208496 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 10.428122520446777 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 44.060821533203125 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 14
Action Durations at step 2407: [10.136197090148926, 39.861331939697266, 17.196779251098633, 7.770722389221191]
Traffic light set to phase 0 for 10.136197090148926 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 39.861331939697266 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 17.196779251098633 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 7.770722389221191 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 15
Action Durations at step 2524: [43.89213943481445, 15.777887344360352, 33.9565315246582, 54.49418258666992]
Traffic light set to phase 0 for 43.89213943481445 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 15.777887344360352 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 33.9565315246582 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 54.49418258666992 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 16
Action Durations at step 2713: [36.73743438720703, 36.10647201538086, 58.80116271972656, 9.499588966369629]
Traffic light set to phase 0 for 36.73743438720703 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 36.10647201538086 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 58.80116271972656 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 9.499588966369629 seconds.
Traffic light set to phase 7 for 10 seconds.
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 87, in <module>
    Simulation.run(episode,epsilon)
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 199, in run
    self.optimize_model()
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 305, in optimize_model
    qeval = self.policy_net(state_batch).gather(1, action_batch)
RuntimeError: gather(): Expected dtype int64 for index