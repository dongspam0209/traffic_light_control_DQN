episode 0
Simulating
Action Durations at step 0: tensor([25.4345, 26.9792, 49.4380, 59.6845])
Traffic light set to phase 0 for 25.434534072875977 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 26.979188919067383 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 49.437957763671875 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 59.68446731567383 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 1
Action Durations at step 203: tensor([58.7746, 59.9228, 12.8276, 28.3398])
Traffic light set to phase 0 for 58.774620056152344 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 59.922828674316406 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 12.827559471130371 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 28.339811325073242 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 2
Action Durations at step 404: tensor([58.8161,  5.9491, 47.1123,  7.3309])
Traffic light set to phase 0 for 58.816131591796875 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 5.949113845825195 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 47.11233901977539 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 7.330944538116455 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 3
Action Durations at step 565: tensor([11.7959, 11.5619, 51.6068,  9.4666])
Traffic light set to phase 0 for 11.795866012573242 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 11.56190299987793 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 51.60676956176758 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 9.466629028320312 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 4
Action Durations at step 691: tensor([47.1863, 53.2120, 29.1847, 24.4091])
Traffic light set to phase 0 for 47.18625259399414 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 53.21200942993164 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 29.184741973876953 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 24.40909767150879 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 5
Action Durations at step 888: tensor([36.1787, 47.0337, 48.9867, 32.4894])
Traffic light set to phase 0 for 36.178672790527344 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 47.033748626708984 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 48.98672866821289 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 32.48936462402344 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 6
Action Durations at step 1095: tensor([21.4839, 53.5154, 33.1545, 54.3196])
Traffic light set to phase 0 for 21.48385238647461 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 53.51540756225586 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 33.15448760986328 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 54.31961441040039 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 7
Action Durations at step 1300: tensor([21.8671, 56.9277, 38.8457, 30.1140])
Traffic light set to phase 0 for 21.867053985595703 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 56.92771911621094 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 38.84566879272461 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 30.11402702331543 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 8
Action Durations at step 1489: tensor([38.8094, 19.8534, 46.1402, 56.7909])
Traffic light set to phase 0 for 38.809391021728516 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 19.853404998779297 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 46.14019775390625 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 56.790924072265625 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 9
Action Durations at step 1692: tensor([28.1642, 13.6214,  5.4902, 56.9197])
Traffic light set to phase 0 for 28.16420555114746 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 13.621444702148438 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 5.490230560302734 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 56.91971969604492 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 10
Action Durations at step 1838: tensor([37.9035, 31.4563,  7.4700, 37.3779])
Traffic light set to phase 0 for 37.90353012084961 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 31.456340789794922 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 7.469995021820068 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 37.377891540527344 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 11
Action Durations at step 1994: tensor([26.1400, 10.6952, 38.2363, 33.9371])
Traffic light set to phase 0 for 26.139984130859375 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 10.695195198059082 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 38.23632049560547 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 33.937095642089844 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 12
Action Durations at step 2145: tensor([19.9357, 56.5206, 19.7480, 15.6915])
Traffic light set to phase 0 for 19.93568229675293 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 56.520591735839844 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 19.748016357421875 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 15.691512107849121 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 13
Action Durations at step 2298: tensor([12.4848, 20.3225, 59.8198, 14.6419])
Traffic light set to phase 0 for 12.484752655029297 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 20.322481155395508 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 59.81977462768555 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 14.641916275024414 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 14
Action Durations at step 2447: tensor([18.3811, 29.5854, 50.1100, 22.3391])
Traffic light set to phase 0 for 18.38113021850586 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 29.585420608520508 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 50.11004638671875 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 22.33905792236328 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 15
Action Durations at step 2610: tensor([41.4385, 27.3473, 37.8193, 57.7300])
Traffic light set to phase 0 for 41.438499450683594 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 27.347251892089844 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 37.819313049316406 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 57.72995376586914 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 16
Action Durations at step 2816: tensor([25.5211,  9.3392, 52.8795, 55.6888])
Traffic light set to phase 0 for 25.521099090576172 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 9.339167594909668 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 52.8795051574707 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 55.68877410888672 seconds.
Traffic light set to phase 7 for 10 seconds.
Action batch shape before view: torch.Size([64])
Action batch shape after view: torch.Size([16, 4])
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 87, in <module>
    Simulation.run(episode,epsilon)
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 199, in run
    self.optimize_model()
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 322, in optimize_model
    action_q_values = current_q_values.gather(1, action_batch.long())
RuntimeError: index 12 is out of bounds for dimension 1 with size 4