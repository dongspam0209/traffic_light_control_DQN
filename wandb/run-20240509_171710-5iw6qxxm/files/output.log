episode 0
Simulating
Action Durations at step 0: tensor([40.1711,  9.8950, 33.8532, 54.1724])
Traffic light set to phase 0 for 40.17107391357422 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 9.895011901855469 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 33.85322189331055 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 54.17236328125 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 1
Action Durations at step 180: tensor([36.4835, 58.9230, 16.4075, 33.7665])
Traffic light set to phase 0 for 36.483482360839844 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 58.9229621887207 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 16.407451629638672 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 33.76654815673828 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 2
Action Durations at step 367: tensor([20.3202, 43.9895, 14.5813, 56.0018])
Traffic light set to phase 0 for 20.320236206054688 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 43.989540100097656 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 14.581311225891113 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 56.00178909301758 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 3
Action Durations at step 544: tensor([ 8.4313, 14.4287, 37.0693, 42.8884])
Traffic light set to phase 0 for 8.431317329406738 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 14.428718566894531 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 37.06926727294922 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 42.88840866088867 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 4
Action Durations at step 689: tensor([38.3296, 11.5483, 38.4227, 35.3726])
Traffic light set to phase 0 for 38.32960510253906 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 11.548250198364258 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 38.42273712158203 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 35.37256622314453 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 5
Action Durations at step 855: tensor([39.0876, 12.2308, 39.4210, 59.7199])
Traffic light set to phase 0 for 39.08756637573242 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 12.230844497680664 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 39.42095184326172 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 59.71991729736328 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 6
Action Durations at step 1048: tensor([12.8177, 37.5896, 12.0865, 24.2006])
Traffic light set to phase 0 for 12.81770133972168 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 37.58956527709961 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 12.086505889892578 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 24.200637817382812 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 7
Action Durations at step 1177: tensor([36.2046, 52.4284, 17.4901, 28.6037])
Traffic light set to phase 0 for 36.20457458496094 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 52.428409576416016 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 17.490062713623047 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 28.603675842285156 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 8
Action Durations at step 1354: tensor([29.6300, 48.9440,  6.3670, 15.0735])
Traffic light set to phase 0 for 29.630008697509766 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 48.94401931762695 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 6.366973400115967 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 15.07347297668457 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 9
Action Durations at step 1496: tensor([47.0120, 19.7433, 32.4304, 41.3404])
Traffic light set to phase 0 for 47.01201248168945 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 19.743331909179688 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 32.430442810058594 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 41.34037399291992 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 10
Action Durations at step 1679: tensor([33.6375, 21.1735, 39.6191, 30.1349])
Traffic light set to phase 0 for 33.63751983642578 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 21.1734676361084 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 39.61907958984375 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 30.13493537902832 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 11
Action Durations at step 1846: tensor([34.0989, 59.4896, 20.3459,  9.9255])
Traffic light set to phase 0 for 34.09889221191406 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 59.48963928222656 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 20.345924377441406 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 9.925519943237305 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 12
Action Durations at step 2012: tensor([50.6999, 35.1790, 11.7166, 43.1386])
Traffic light set to phase 0 for 50.699893951416016 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 35.17897415161133 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 11.71662425994873 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 43.1385612487793 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 13
Action Durations at step 2195: tensor([40.3144, 34.5797, 32.0801, 40.9193])
Traffic light set to phase 0 for 40.314361572265625 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 34.5797119140625 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 32.08014678955078 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 40.91926956176758 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 14
Action Durations at step 2385: tensor([17.6214, 30.0307, 25.3892, 11.3576])
Traffic light set to phase 0 for 17.621356964111328 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 30.030651092529297 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 25.38919448852539 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 11.357566833496094 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 15
Action Durations at step 2512: tensor([43.3672, 38.2923, 31.6241,  7.4904])
Traffic light set to phase 0 for 43.36716842651367 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 38.29230880737305 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 31.62409210205078 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 7.490392208099365 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 16
Action Durations at step 2675: tensor([52.6395, 17.5277, 57.1143, 56.0616])
Traffic light set to phase 0 for 52.639530181884766 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 17.52770233154297 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 57.11428451538086 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 56.06162643432617 seconds.
Traffic light set to phase 7 for 10 seconds.
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 87, in <module>
    Simulation.run(episode,epsilon)
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 197, in run
    self.optimize_model()
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 319, in optimize_model
    q_eval = q_values.gather(1, action_durations.unsqueeze(1))
RuntimeError: gather(): Expected dtype int64 for index