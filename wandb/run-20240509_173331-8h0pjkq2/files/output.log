episode 0
Simulating
Action Durations at step 0: tensor([ 7.2209, 48.7446, 18.4835, 24.2597])
Traffic light set to phase 0 for 7.220867156982422 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 48.74462890625 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 18.483539581298828 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 24.259748458862305 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 1
Action Durations at step 141: tensor([ 9.6459, 56.7076, 34.0180, 29.6827])
Traffic light set to phase 0 for 9.645946502685547 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 56.70759201049805 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 34.01796340942383 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 29.6827392578125 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 2
Action Durations at step 313: tensor([58.8097, 31.1540, 40.2382, 28.8159])
Traffic light set to phase 0 for 58.809654235839844 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 31.153961181640625 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 40.23823165893555 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 28.815866470336914 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 3
Action Durations at step 514: tensor([23.8850, 58.7980, 30.5878, 55.6040])
Traffic light set to phase 0 for 23.884963989257812 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 58.798011779785156 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 30.587806701660156 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 55.603981018066406 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 4
Action Durations at step 724: tensor([58.4772, 21.6666,  7.0059, 44.1053])
Traffic light set to phase 0 for 58.47719192504883 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 21.66657829284668 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 7.005934715270996 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 44.10531997680664 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 5
Action Durations at step 898: tensor([25.5241, 14.1865, 11.2442, 52.1013])
Traffic light set to phase 0 for 25.524145126342773 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 14.186458587646484 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 11.24421501159668 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 52.101287841796875 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 6
Action Durations at step 1044: tensor([25.5344, 49.9471, 59.5926, 45.0560])
Traffic light set to phase 0 for 25.534381866455078 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 49.94708251953125 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 59.59260177612305 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 45.0560188293457 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 7
Action Durations at step 1266: tensor([27.9123, 15.1916, 14.4727, 17.1718])
Traffic light set to phase 0 for 27.912321090698242 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 15.191630363464355 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 14.47266674041748 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 17.17176628112793 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 8
Action Durations at step 1383: tensor([46.9179, 15.6527, 12.4053, 50.1454])
Traffic light set to phase 0 for 46.91790008544922 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 15.65273666381836 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 12.405329704284668 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 50.145442962646484 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 9
Action Durations at step 1550: tensor([54.9764, 52.8089,  7.9445, 16.6348])
Traffic light set to phase 0 for 54.9764289855957 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 52.80891036987305 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 7.9444732666015625 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 16.634830474853516 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 10
Action Durations at step 1723: tensor([ 9.7268, 52.7708, 39.5286, 54.0825])
Traffic light set to phase 0 for 9.72675895690918 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 52.77078628540039 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 39.52861404418945 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 54.08250045776367 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 11
Action Durations at step 1921: tensor([42.8332, 48.9187, 54.4378, 42.2400])
Traffic light set to phase 0 for 42.833160400390625 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 48.918739318847656 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 54.437782287597656 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 42.239994049072266 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 12
Action Durations at step 2151: tensor([50.2113, 34.0314, 13.7868, 35.4025])
Traffic light set to phase 0 for 50.21128463745117 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 34.03141784667969 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 13.786770820617676 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 35.402488708496094 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 13
Action Durations at step 2327: tensor([20.4237, 14.7709, 18.0263, 57.6792])
Traffic light set to phase 0 for 20.423677444458008 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 14.770909309387207 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 18.02633285522461 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 57.67918395996094 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 14
Action Durations at step 2480: tensor([38.5590, 53.8490, 58.4548, 18.0382])
Traffic light set to phase 0 for 38.558963775634766 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 53.849037170410156 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 58.454811096191406 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 18.0382022857666 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 15
Action Durations at step 2691: tensor([21.2630, 22.9294,  7.4802, 33.6810])
Traffic light set to phase 0 for 21.262985229492188 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 22.92935562133789 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 7.480213165283203 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 33.68096923828125 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 16
Action Durations at step 2818: tensor([10.8814, 33.0754, 47.8019, 50.0135])
Traffic light set to phase 0 for 10.881389617919922 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 33.07537078857422 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 47.80192947387695 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 50.01345443725586 seconds.
Traffic light set to phase 7 for 10 seconds.
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 87, in <module>
    Simulation.run(episode,epsilon)
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 197, in run
    self.optimize_model()
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 315, in optimize_model
    q_eval = self.policy_net(state_batch).gather(1, action_batch)
RuntimeError: gather(): Expected dtype int64 for index