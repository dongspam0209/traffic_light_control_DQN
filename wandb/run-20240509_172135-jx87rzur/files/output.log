episode 0
Simulating
Action Durations at step 0: tensor([56.6319, 30.6024, 16.9946, 34.0841])
Traffic light set to phase 0 for 56.631919860839844 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 30.602407455444336 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 16.994647979736328 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 34.084136962890625 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 1
Action Durations at step 180: tensor([40.6727, 54.6543, 59.0377, 55.7017])
Traffic light set to phase 0 for 40.672691345214844 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 54.65425491333008 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 59.037662506103516 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 55.70167922973633 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 2
Action Durations at step 432: tensor([59.2679, 49.7672, 21.7776, 31.0104])
Traffic light set to phase 0 for 59.26789093017578 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 49.76721954345703 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 21.777587890625 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 31.010448455810547 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 3
Action Durations at step 636: tensor([ 6.2646, 43.7702, 39.8032, 20.6585])
Traffic light set to phase 0 for 6.264570713043213 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 43.770240783691406 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 39.80320739746094 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 20.65849494934082 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 4
Action Durations at step 788: tensor([33.1863, 27.2377, 17.4567, 23.1232])
Traffic light set to phase 0 for 33.18630599975586 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 27.2376651763916 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 17.45673370361328 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 23.123153686523438 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 5
Action Durations at step 932: tensor([36.6673, 54.0200, 20.1790, 53.1405])
Traffic light set to phase 0 for 36.66729736328125 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 54.01999282836914 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 20.179004669189453 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 53.14053726196289 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 6
Action Durations at step 1139: tensor([23.6430, 57.1785, 14.3864, 49.9653])
Traffic light set to phase 0 for 23.64299964904785 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 57.17848587036133 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 14.386438369750977 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 49.96525955200195 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 7
Action Durations at step 1326: tensor([ 8.1353, 56.4745, 32.1407, 43.0359])
Traffic light set to phase 0 for 8.135336875915527 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 56.474491119384766 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 32.140724182128906 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 43.03593826293945 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 8
Action Durations at step 1509: tensor([34.1208,  8.5072, 17.5695,  7.8410])
Traffic light set to phase 0 for 34.12078094482422 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 8.507238388061523 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 17.56951904296875 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 7.841014862060547 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 9
Action Durations at step 1619: tensor([33.2442, 40.0918, 38.2696, 52.6826])
Traffic light set to phase 0 for 33.24419403076172 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 40.09175491333008 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 38.26960754394531 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 52.6826286315918 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 10
Action Durations at step 1826: tensor([37.8672, 45.2281, 35.2394, 56.3249])
Traffic light set to phase 0 for 37.86716079711914 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 45.22809982299805 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 35.23938751220703 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 56.324886322021484 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 11
Action Durations at step 2043: tensor([47.2158, 26.0009,  7.1391, 21.7840])
Traffic light set to phase 0 for 47.2158317565918 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 26.000926971435547 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 7.1390581130981445 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 21.78395652770996 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 12
Action Durations at step 2188: tensor([35.5110, 32.4670, 26.0913, 30.5927])
Traffic light set to phase 0 for 35.51103591918945 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 32.46697235107422 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 26.091341018676758 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 30.59266471862793 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 13
Action Durations at step 2355: tensor([46.4486, 56.6964, 15.2029, 55.8554])
Traffic light set to phase 0 for 46.4486198425293 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 56.69639205932617 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 15.202940940856934 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 55.85535430908203 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 14
Action Durations at step 2571: tensor([29.7941, 53.5632, 36.0579, 16.4459])
Traffic light set to phase 0 for 29.7940731048584 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 53.563209533691406 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 36.05794906616211 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 16.44594955444336 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 15
Action Durations at step 2749: tensor([ 5.7362, 22.3290, 28.3914, 27.7272])
Traffic light set to phase 0 for 5.736230850219727 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 22.32896614074707 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 28.391408920288086 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 27.72723388671875 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 16
Action Durations at step 2875: tensor([59.8432, 11.6169, 44.0666, 32.6585])
Traffic light set to phase 0 for 59.843170166015625 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 11.616872787475586 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 44.06660461425781 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 32.65851593017578 seconds.
Traffic light set to phase 7 for 10 seconds.
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 87, in <module>
    Simulation.run(episode,epsilon)
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 197, in run
    self.optimize_model()
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 319, in optimize_model
    q_eval = q_values.gather(1, action_durations.view(-1, 1))
RuntimeError: Size does not match at dimension 0 expected index [64, 1] to be smaller than self [16, 4] apart from dimension 1