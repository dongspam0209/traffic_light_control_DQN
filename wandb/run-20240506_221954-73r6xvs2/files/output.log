
episode 0
Simulating
prev_actions_batch tensor([[ 3,  3],
        [ 1,  0],
        [ 0,  2],
        [ 2,  3],
        [ 3,  1],
        [ 2,  2],
        [ 1,  3],
        [ 3,  0],
        [ 0,  1],
        [ 1,  1],
        [ 3,  3],
        [ 2,  0],
        [ 3,  0],
        [ 2,  3],
        [ 3,  1],
        [ 2,  1],
        [ 2,  1],
        [ 1,  2],
        [ 0,  0],
        [ 1,  0],
        [ 2,  3],
        [ 0,  3],
        [ 0,  3],
        [ 1,  3],
        [ 2,  1],
        [ 0,  2],
        [ 2,  0],
        [ 2,  2],
        [ 1,  2],
        [ 0,  0],
        [ 1,  3],
        [ 2,  3],
        [ 0,  3],
        [ 3,  2],
        [ 0,  3],
        [ 1,  1],
        [ 3,  0],
        [ 3,  0],
        [ 2,  0],
        [ 3,  1],
        [ 1,  1],
        [ 0,  0],
        [ 2,  0],
        [ 3,  2],
        [ 1,  2],
        [ 2,  2],
        [ 3,  2],
        [ 3,  1],
        [ 3,  3],
        [ 3,  2],
        [ 0,  3],
        [ 2,  1],
        [ 2,  2],
        [ 2,  3],
        [-1,  3],
        [ 3,  3],
        [ 0,  0],
        [ 0,  2],
        [ 1,  2],
        [ 2,  3],
        [ 1,  0],
        [ 2,  3],
        [ 0,  3],
        [ 3,  3],
        [ 1,  1],
        [ 0,  2],
        [ 0,  0],
        [ 3,  2],
        [ 3,  3],
        [ 0,  2],
        [ 0,  2],
        [ 3,  1],
        [ 0,  1],
        [ 3,  2],
        [ 0,  0],
        [ 3,  2],
        [ 3,  1],
        [ 0,  1],
        [ 3,  0],
        [ 1,  0],
        [ 1,  3],
        [ 3,  0],
        [ 0,  0],
        [ 2,  0],
        [ 2,  3],
        [ 0,  0],
        [ 0,  0],
        [ 1,  2],
        [ 3,  0],
        [ 0,  0],
        [ 1,  1],
        [ 2,  1],
        [ 3,  1],
        [ 1,  0],
        [ 1,  0],
        [ 3,  0],
        [ 1,  1],
        [ 3,  0],
        [ 0,  0],
        [ 3,  1],
        [ 3,  2],
        [ 0,  3],
        [ 0,  0],
        [ 3,  2],
        [ 0,  3],
        [ 1,  1],
        [ 1,  3],
        [ 1,  0],
        [ 0,  1],
        [ 2,  0],
        [ 1,  3],
        [ 0,  2],
        [ 2,  3],
        [ 2,  0],
        [ 0,  3],
        [ 1,  3],
        [ 0,  2],
        [ 1,  2],
        [ 3,  3],
        [ 0,  0],
        [ 0,  0],
        [ 2,  1],
        [ 3,  0],
        [ 0,  3],
        [ 2,  0],
        [ 0,  3],
        [ 0,  1],
        [ 0,  1]])
model에서의 prev_action tensor([[ 3,  3],
        [ 1,  0],
        [ 0,  2],
        [ 2,  3],
        [ 3,  1],
        [ 2,  2],
        [ 1,  3],
        [ 3,  0],
        [ 0,  1],
        [ 1,  1],
        [ 3,  3],
        [ 2,  0],
        [ 3,  0],
        [ 2,  3],
        [ 3,  1],
        [ 2,  1],
        [ 2,  1],
        [ 1,  2],
        [ 0,  0],
        [ 1,  0],
        [ 2,  3],
        [ 0,  3],
        [ 0,  3],
        [ 1,  3],
        [ 2,  1],
        [ 0,  2],
        [ 2,  0],
        [ 2,  2],
        [ 1,  2],
        [ 0,  0],
        [ 1,  3],
        [ 2,  3],
        [ 0,  3],
        [ 3,  2],
        [ 0,  3],
        [ 1,  1],
        [ 3,  0],
        [ 3,  0],
        [ 2,  0],
        [ 3,  1],
        [ 1,  1],
        [ 0,  0],
        [ 2,  0],
        [ 3,  2],
        [ 1,  2],
        [ 2,  2],
        [ 3,  2],
        [ 3,  1],
        [ 3,  3],
        [ 3,  2],
        [ 0,  3],
        [ 2,  1],
        [ 2,  2],
        [ 2,  3],
        [-1,  3],
        [ 3,  3],
        [ 0,  0],
        [ 0,  2],
        [ 1,  2],
        [ 2,  3],
        [ 1,  0],
        [ 2,  3],
        [ 0,  3],
        [ 3,  3],
        [ 1,  1],
        [ 0,  2],
        [ 0,  0],
        [ 3,  2],
        [ 3,  3],
        [ 0,  2],
        [ 0,  2],
        [ 3,  1],
        [ 0,  1],
        [ 3,  2],
        [ 0,  0],
        [ 3,  2],
        [ 3,  1],
        [ 0,  1],
        [ 3,  0],
        [ 1,  0],
        [ 1,  3],
        [ 3,  0],
        [ 0,  0],
        [ 2,  0],
        [ 2,  3],
        [ 0,  0],
        [ 0,  0],
        [ 1,  2],
        [ 3,  0],
        [ 0,  0],
        [ 1,  1],
        [ 2,  1],
        [ 3,  1],
        [ 1,  0],
        [ 1,  0],
        [ 3,  0],
        [ 1,  1],
        [ 3,  0],
        [ 0,  0],
        [ 3,  1],
        [ 3,  2],
        [ 0,  3],
        [ 0,  0],
        [ 3,  2],
        [ 0,  3],
        [ 1,  1],
        [ 1,  3],
        [ 1,  0],
        [ 0,  1],
        [ 2,  0],
        [ 1,  3],
        [ 0,  2],
        [ 2,  3],
        [ 2,  0],
        [ 0,  3],
        [ 1,  3],
        [ 0,  2],
        [ 1,  2],
        [ 3,  3],
        [ 0,  0],
        [ 0,  0],
        [ 2,  1],
        [ 3,  0],
        [ 0,  3],
        [ 2,  0],
        [ 0,  3],
        [ 0,  1],
        [ 0,  1]])
이전 action 추가한 shape;  torch.Size([128, 9602])
model에서의 prev_action tensor([[ 3,  3],
        [ 1,  0],
        [ 0,  2],
        [ 2,  3],
        [ 3,  1],
        [ 2,  2],
        [ 1,  3],
        [ 3,  0],
        [ 0,  1],
        [ 1,  1],
        [ 3,  3],
        [ 2,  0],
        [ 3,  0],
        [ 2,  3],
        [ 3,  1],
        [ 2,  1],
        [ 2,  1],
        [ 1,  2],
        [ 0,  0],
        [ 1,  0],
        [ 2,  3],
        [ 0,  3],
        [ 0,  3],
        [ 1,  3],
        [ 2,  1],
        [ 0,  2],
        [ 2,  0],
        [ 2,  2],
        [ 1,  2],
        [ 0,  0],
        [ 1,  3],
        [ 2,  3],
        [ 0,  3],
        [ 3,  2],
        [ 0,  3],
        [ 1,  1],
        [ 3,  0],
        [ 3,  0],
        [ 2,  0],
        [ 3,  1],
        [ 1,  1],
        [ 0,  0],
        [ 2,  0],
        [ 3,  2],
        [ 1,  2],
        [ 2,  2],
        [ 3,  2],
        [ 3,  1],
        [ 3,  3],
        [ 3,  2],
        [ 0,  3],
        [ 2,  1],
        [ 2,  2],
        [ 2,  3],
        [-1,  3],
        [ 3,  3],
        [ 0,  0],
        [ 0,  2],
        [ 1,  2],
        [ 2,  3],
        [ 1,  0],
        [ 2,  3],
        [ 0,  3],
        [ 3,  3],
        [ 1,  1],
        [ 0,  2],
        [ 0,  0],
        [ 3,  2],
        [ 3,  3],
        [ 0,  2],
        [ 0,  2],
        [ 3,  1],
        [ 0,  1],
        [ 3,  2],
        [ 0,  0],
        [ 3,  2],
        [ 3,  1],
        [ 0,  1],
        [ 3,  0],
        [ 1,  0],
        [ 1,  3],
        [ 3,  0],
        [ 0,  0],
        [ 2,  0],
        [ 2,  3],
        [ 0,  0],
        [ 0,  0],
        [ 1,  2],
        [ 3,  0],
        [ 0,  0],
        [ 1,  1],
        [ 2,  1],
        [ 3,  1],
        [ 1,  0],
        [ 1,  0],
        [ 3,  0],
        [ 1,  1],
        [ 3,  0],
        [ 0,  0],
        [ 3,  1],
        [ 3,  2],
        [ 0,  3],
        [ 0,  0],
        [ 3,  2],
        [ 0,  3],
        [ 1,  1],
        [ 1,  3],
        [ 1,  0],
        [ 0,  1],
        [ 2,  0],
        [ 1,  3],
        [ 0,  2],
        [ 2,  3],
        [ 2,  0],
        [ 0,  3],
        [ 1,  3],
        [ 0,  2],
        [ 1,  2],
        [ 3,  3],
        [ 0,  0],
        [ 0,  0],
        [ 2,  1],
        [ 3,  0],
        [ 0,  3],
        [ 2,  0],
        [ 0,  3],
        [ 0,  1],
        [ 0,  1]])
이전 action 추가한 shape;  torch.Size([128, 9602])
prev_actions_batch tensor([[ 1,  2],
        [ 3,  2],
        [ 3,  0],
        [ 1,  1],
        [ 0,  0],
        [ 1,  3],
        [ 2,  3],
        [ 0,  0],
        [ 3,  3],
        [ 2,  2],
        [ 2,  1],
        [-1,  3],
        [ 1,  0],
        [ 2,  0],
        [ 3,  3],
        [ 0,  0],
        [ 0,  0],
        [ 0,  1],
        [ 3,  0],
        [ 3,  3],
        [ 0,  3],
        [ 0,  0],
        [ 3,  1],
        [ 1,  1],
        [ 2,  1],
        [ 3,  1],
        [ 0,  1],
        [ 1,  0],
        [ 3,  2],
        [ 1,  3],
        [ 0,  0],
        [ 0,  2],
        [ 0,  3],
        [ 0,  3],
        [ 0,  0],
        [ 0,  2],
        [ 0,  0],
        [ 3,  1],
        [ 1,  2],
        [ 3,  2],
        [ 1,  2],
        [ 2,  0],
        [ 2,  3],
        [ 2,  3],
        [ 2,  1],
        [ 2,  0],
        [ 3,  1],
        [ 2,  3],
        [ 3,  3],
        [ 2,  2],
        [ 0,  3],
        [ 2,  0],
        [ 2,  2],
        [ 0,  0],
        [ 2,  0],
        [ 2,  1],
        [ 0,  0],
        [ 3,  1],
        [ 0,  1],
        [ 0,  2],
        [ 3,  3],
        [ 3,  2],
        [ 3,  0],
        [ 3,  0],
        [ 1,  0],
        [ 0,  1],
        [ 3,  0],
        [ 2,  0],
        [ 2,  0],
        [ 2,  3],
        [ 3,  0],
        [ 2,  2],
        [ 1,  0],
        [ 3,  0],
        [ 2,  0],
        [ 1,  1],
        [ 0,  1],
        [ 3,  1],
        [ 3,  0],
        [ 0,  0],
        [ 3,  3],
        [ 0,  3],
        [ 0,  2],
        [ 1,  1],
        [ 0,  2],
        [ 1,  2],
        [ 0,  1],
        [ 3,  1],
        [ 3,  0],
        [ 3,  0],
        [ 0,  2],
        [ 0,  2],
        [ 1,  3],
        [ 3,  2],
        [ 0,  3],
        [ 3,  2],
        [ 0,  2],
        [ 0,  0],
        [ 1,  3],
        [ 2,  3],
        [ 2,  1],
        [ 0,  0],
        [ 2,  3],
        [ 1,  3],
        [ 3,  1],
        [ 0,  3],
        [ 2,  3],
        [ 3,  2],
        [ 0,  3],
        [ 1,  1],
        [ 0,  0],
        [ 3,  3],
        [ 1,  1],
        [ 3,  2],
        [ 3,  2],
        [ 1,  1],
        [ 3,  2],
        [ 1,  2],
        [ 2,  1],
        [ 0,  3],
        [ 1,  3],
        [ 0,  3],
        [ 0,  3],
        [ 1,  0],
        [ 1,  3],
        [ 1,  0],
        [ 2,  3],
        [ 1,  2]])
model에서의 prev_action tensor([[ 1,  2],
        [ 3,  2],
        [ 3,  0],
        [ 1,  1],
        [ 0,  0],
        [ 1,  3],
        [ 2,  3],
        [ 0,  0],
        [ 3,  3],
        [ 2,  2],
        [ 2,  1],
        [-1,  3],
        [ 1,  0],
        [ 2,  0],
        [ 3,  3],
        [ 0,  0],
        [ 0,  0],
        [ 0,  1],
        [ 3,  0],
        [ 3,  3],
        [ 0,  3],
        [ 0,  0],
        [ 3,  1],
        [ 1,  1],
        [ 2,  1],
        [ 3,  1],
        [ 0,  1],
        [ 1,  0],
        [ 3,  2],
        [ 1,  3],
        [ 0,  0],
        [ 0,  2],
        [ 0,  3],
        [ 0,  3],
        [ 0,  0],
        [ 0,  2],
        [ 0,  0],
        [ 3,  1],
        [ 1,  2],
        [ 3,  2],
        [ 1,  2],
        [ 2,  0],
        [ 2,  3],
        [ 2,  3],
        [ 2,  1],
        [ 2,  0],
        [ 3,  1],
        [ 2,  3],
        [ 3,  3],
        [ 2,  2],
        [ 0,  3],
        [ 2,  0],
        [ 2,  2],
        [ 0,  0],
        [ 2,  0],
        [ 2,  1],
        [ 0,  0],
        [ 3,  1],
        [ 0,  1],
        [ 0,  2],
        [ 3,  3],
        [ 3,  2],
        [ 3,  0],
        [ 3,  0],
        [ 1,  0],
        [ 0,  1],
        [ 3,  0],
        [ 2,  0],
        [ 2,  0],
        [ 2,  3],
        [ 3,  0],
        [ 2,  2],
        [ 1,  0],
        [ 3,  0],
        [ 2,  0],
        [ 1,  1],
        [ 0,  1],
        [ 3,  1],
        [ 3,  0],
        [ 0,  0],
        [ 3,  3],
        [ 0,  3],
        [ 0,  2],
        [ 1,  1],
        [ 0,  2],
        [ 1,  2],
        [ 0,  1],
        [ 3,  1],
        [ 3,  0],
        [ 3,  0],
        [ 0,  2],
        [ 0,  2],
        [ 1,  3],
        [ 3,  2],
        [ 0,  3],
        [ 3,  2],
        [ 0,  2],
        [ 0,  0],
        [ 1,  3],
        [ 2,  3],
        [ 2,  1],
        [ 0,  0],
        [ 2,  3],
        [ 1,  3],
        [ 3,  1],
        [ 0,  3],
        [ 2,  3],
        [ 3,  2],
        [ 0,  3],
        [ 1,  1],
        [ 0,  0],
        [ 3,  3],
        [ 1,  1],
        [ 3,  2],
        [ 3,  2],
        [ 1,  1],
        [ 3,  2],
        [ 1,  2],
        [ 2,  1],
        [ 0,  3],
        [ 1,  3],
        [ 0,  3],
        [ 0,  3],
        [ 1,  0],
        [ 1,  3],
        [ 1,  0],
        [ 2,  3],
        [ 1,  2]])
이전 action 추가한 shape;  torch.Size([128, 9602])
model에서의 prev_action tensor([[ 1,  2],
        [ 3,  2],
        [ 3,  0],
        [ 1,  1],
        [ 0,  0],
        [ 1,  3],
        [ 2,  3],
        [ 0,  0],
        [ 3,  3],
        [ 2,  2],
        [ 2,  1],
        [-1,  3],
        [ 1,  0],
        [ 2,  0],
        [ 3,  3],
        [ 0,  0],
        [ 0,  0],
        [ 0,  1],
        [ 3,  0],
        [ 3,  3],
        [ 0,  3],
        [ 0,  0],
        [ 3,  1],
        [ 1,  1],
        [ 2,  1],
        [ 3,  1],
        [ 0,  1],
        [ 1,  0],
        [ 3,  2],
        [ 1,  3],
        [ 0,  0],
        [ 0,  2],
        [ 0,  3],
        [ 0,  3],
        [ 0,  0],
        [ 0,  2],
        [ 0,  0],
        [ 3,  1],
        [ 1,  2],
        [ 3,  2],
        [ 1,  2],
        [ 2,  0],
        [ 2,  3],
        [ 2,  3],
        [ 2,  1],
        [ 2,  0],
        [ 3,  1],
        [ 2,  3],
        [ 3,  3],
        [ 2,  2],
        [ 0,  3],
        [ 2,  0],
        [ 2,  2],
        [ 0,  0],
        [ 2,  0],
        [ 2,  1],
        [ 0,  0],
        [ 3,  1],
        [ 0,  1],
        [ 0,  2],
        [ 3,  3],
        [ 3,  2],
        [ 3,  0],
        [ 3,  0],
        [ 1,  0],
        [ 0,  1],
        [ 3,  0],
        [ 2,  0],
        [ 2,  0],
        [ 2,  3],
        [ 3,  0],
        [ 2,  2],
        [ 1,  0],
        [ 3,  0],
        [ 2,  0],
        [ 1,  1],
        [ 0,  1],
        [ 3,  1],
        [ 3,  0],
        [ 0,  0],
        [ 3,  3],
        [ 0,  3],
        [ 0,  2],
        [ 1,  1],
        [ 0,  2],
        [ 1,  2],
        [ 0,  1],
        [ 3,  1],
        [ 3,  0],
        [ 3,  0],
        [ 0,  2],
        [ 0,  2],
        [ 1,  3],
        [ 3,  2],
        [ 0,  3],
        [ 3,  2],
        [ 0,  2],
        [ 0,  0],
        [ 1,  3],
        [ 2,  3],
        [ 2,  1],
        [ 0,  0],
        [ 2,  3],
        [ 1,  3],
        [ 3,  1],
        [ 0,  3],
        [ 2,  3],
        [ 3,  2],
        [ 0,  3],
        [ 1,  1],
        [ 0,  0],
        [ 3,  3],
        [ 1,  1],
        [ 3,  2],
        [ 3,  2],
        [ 1,  1],
        [ 3,  2],
        [ 1,  2],
        [ 2,  1],
        [ 0,  3],
        [ 1,  3],
        [ 0,  3],
        [ 0,  3],
        [ 1,  0],
        [ 1,  3],
        [ 1,  0],
        [ 2,  3],
        [ 1,  2]])
이전 action 추가한 shape;  torch.Size([128, 9602])
Traceback (most recent call last):
  File "C:\Users\MNL431\Desktop\traffic_DQN\training_main.py", line 83, in <module>
    Simulation.run(episode,epsilon)
  File "C:\Users\MNL431\Desktop\traffic_DQN\simulation.py", line 188, in run
    self._simulate(duration)
  File "C:\Users\MNL431\Desktop\traffic_DQN\simulation.py", line 285, in _simulate
    traci.simulationStep()  # simulate 1 step in sumo
  File "C:\Program Files (x86)\Eclipse\Sumo\tools\traci\main.py", line 198, in simulationStep
    connection.check().simulationStep(step)
  File "C:\Program Files (x86)\Eclipse\Sumo\tools\traci\connection.py", line 368, in simulationStep
    result = self._sendCmd(tc.CMD_SIMSTEP, None, None, "D", step)
  File "C:\Program Files (x86)\Eclipse\Sumo\tools\traci\connection.py", line 231, in _sendCmd
    return self._sendExact()
  File "C:\Program Files (x86)\Eclipse\Sumo\tools\traci\connection.py", line 137, in _sendExact
    raise FatalTraCIError("Connection closed by SUMO.")
traci.exceptions.FatalTraCIError: Connection closed by SUMO.