episode 0
Simulating
Action Durations at step 0: tensor([23.4222, 11.5677, 59.6376, 35.1495])
Traffic light set to phase 0 for 23.4222412109375 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 11.567696571350098 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 59.63759994506836 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 35.14954376220703 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 0 needed: 128
Total experiences in memory: 1
Action Durations at step 172: tensor([28.9506, 38.1893, 55.9434, 41.5635])
Traffic light set to phase 0 for 28.95063018798828 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 38.189292907714844 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 55.94335174560547 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 41.563499450683594 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 1 needed: 128
Total experiences in memory: 2
Action Durations at step 378: tensor([55.9115, 46.8706, 23.4321, 32.1674])
Traffic light set to phase 0 for 55.911476135253906 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 46.870601654052734 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 23.432146072387695 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 32.16743469238281 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 2 needed: 128
Total experiences in memory: 3
Action Durations at step 578: tensor([22.0907, 41.9636,  5.5809, 32.2331])
Traffic light set to phase 0 for 22.090682983398438 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 41.96360397338867 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 5.580900192260742 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 32.233131408691406 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 3 needed: 128
Total experiences in memory: 4
Action Durations at step 722: tensor([ 8.4074, 11.9821, 37.4385, 32.8711])
Traffic light set to phase 0 for 8.407428741455078 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 11.982080459594727 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 37.43845748901367 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 32.87112808227539 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 4 needed: 128
Total experiences in memory: 5
Action Durations at step 854: tensor([56.5091, 23.7866, 53.6083, 49.7562])
Traffic light set to phase 0 for 56.50905227661133 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 23.78664207458496 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 53.6082878112793 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 49.75619125366211 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 5 needed: 128
Total experiences in memory: 6
Action Durations at step 1079: tensor([59.4693, 48.1274, 14.0491,  6.5330])
Traffic light set to phase 0 for 59.46929168701172 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 48.1274299621582 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 14.049139022827148 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 6.533026695251465 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 6 needed: 128
Total experiences in memory: 7
Action Durations at step 1250: tensor([14.0542,  8.2670, 30.5359, 32.1924])
Traffic light set to phase 0 for 14.054197311401367 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 8.267014503479004 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 30.535884857177734 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 32.19239807128906 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 7 needed: 128
Total experiences in memory: 8
Action Durations at step 1378: tensor([40.2923, 41.3680, 33.9326, 39.0981])
Traffic light set to phase 0 for 40.29231643676758 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 41.36804962158203 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 33.93259048461914 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 39.098121643066406 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 8 needed: 128
Total experiences in memory: 9
Action Durations at step 1575: tensor([51.1873, 15.9348, 18.9342, 44.1514])
Traffic light set to phase 0 for 51.18730545043945 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 15.934807777404785 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 18.934192657470703 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 44.15144348144531 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 9 needed: 128
Total experiences in memory: 10
Action Durations at step 1747: tensor([22.0474, 41.4045, 45.7164, 53.9400])
Traffic light set to phase 0 for 22.047401428222656 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 41.40453338623047 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 45.71635818481445 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 53.93996047973633 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 10 needed: 128
Total experiences in memory: 11
Action Durations at step 1952: tensor([ 9.1867, 12.6157, 54.5733, 50.1956])
Traffic light set to phase 0 for 9.1867094039917 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 12.615675926208496 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 54.5732536315918 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 50.19559860229492 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 11 needed: 128
Total experiences in memory: 12
Action Durations at step 2121: tensor([36.3153, 54.2963, 22.3628, 27.7565])
Traffic light set to phase 0 for 36.31534194946289 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 54.29627990722656 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 22.36275863647461 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 27.756498336791992 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 12 needed: 128
Total experiences in memory: 13
Action Durations at step 2304: tensor([35.8235, 52.2575, 23.5167, 52.3666])
Traffic light set to phase 0 for 35.823486328125 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 52.25749206542969 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 23.516691207885742 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 52.3665885925293 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 13 needed: 128
Total experiences in memory: 14
Action Durations at step 2510: tensor([ 7.3115, 53.2843, 10.4018, 50.5802])
Traffic light set to phase 0 for 7.311514377593994 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 53.284324645996094 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 10.40176773071289 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 50.58018112182617 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 14 needed: 128
Total experiences in memory: 15
Action Durations at step 2674: tensor([42.5079, 56.6876, 25.5766, 57.3869])
Traffic light set to phase 0 for 42.50794219970703 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 56.687599182128906 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 25.576553344726562 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 57.386863708496094 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 15 needed: 128
Total experiences in memory: 16
Action Durations at step 2898: tensor([35.8187, 58.6193, 20.0187, 37.5828])
Traffic light set to phase 0 for 35.81874084472656 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 58.619258880615234 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 20.018678665161133 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 37.58278274536133 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 16 needed: 128
Total experiences in memory: 17
Action Durations at step 3092: tensor([31.7084, 11.4770, 12.8202, 47.8412])
Traffic light set to phase 0 for 31.708419799804688 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 11.476997375488281 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 12.82019329071045 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 47.84120559692383 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 17 needed: 128
Total experiences in memory: 18
Action Durations at step 3237: tensor([36.3076, 35.5550, 14.0264, 21.7258])
Traffic light set to phase 0 for 36.307579040527344 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 35.555023193359375 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 14.026407241821289 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 21.72577476501465 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 18 needed: 128
Total experiences in memory: 19
Action Durations at step 3387: tensor([33.1419,  7.4890, 39.6491,  5.5479])
Traffic light set to phase 0 for 33.141944885253906 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 7.489045143127441 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 39.64908218383789 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 5.547940731048584 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 19 needed: 128
Total experiences in memory: 20
Action Durations at step 3515: tensor([54.1204, 24.8454, 29.6761, 42.3599])
Traffic light set to phase 0 for 54.12042999267578 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 24.845443725585938 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 29.676067352294922 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 42.359886169433594 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 20 needed: 128
epsilon : 1.000
queue length in epsiode 0 0.03586839266450917
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 89, in <module>
    print(f'loss in epsiode {episode}',Simulation.loss_store[episode])
IndexError: list index out of range