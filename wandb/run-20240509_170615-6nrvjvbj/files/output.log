episode 0
Simulating
Action Durations at step 0: tensor([57.6555, 29.9158,  9.9178, 37.6480])
Traffic light set to phase 0 for 57.65553283691406 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 29.915813446044922 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 9.917786598205566 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 37.64802551269531 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 0 needed: 128
optimize model
Total experiences in memory: 1
Action Durations at step 176: tensor([15.8489,  5.7706, 10.8030, 32.2369])
Traffic light set to phase 0 for 15.848872184753418 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 5.770589828491211 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 10.802974700927734 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 32.23688507080078 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 1 needed: 128
optimize model
Total experiences in memory: 2
Action Durations at step 282: tensor([32.9355, 41.5179, 19.7691, 20.9426])
Traffic light set to phase 0 for 32.935508728027344 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 41.51793670654297 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 19.769123077392578 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 20.942602157592773 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 2 needed: 128
optimize model
Total experiences in memory: 3
Action Durations at step 438: tensor([17.1521, 23.2236, 56.9938, 37.3759])
Traffic light set to phase 0 for 17.152122497558594 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 23.223648071289062 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 56.99384689331055 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 37.37594985961914 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 3 needed: 128
optimize model
Total experiences in memory: 4
Action Durations at step 615: tensor([23.9831, 57.6340, 23.5066, 13.4781])
Traffic light set to phase 0 for 23.98309898376465 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 57.63404846191406 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 23.506620407104492 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 13.478145599365234 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 4 needed: 128
optimize model
Total experiences in memory: 5
Action Durations at step 775: tensor([31.8219, 58.8499, 43.3681,  5.0221])
Traffic light set to phase 0 for 31.821945190429688 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 58.84991455078125 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 43.36812210083008 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 5.022108554840088 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 5 needed: 128
optimize model
Total experiences in memory: 6
Action Durations at step 956: tensor([31.8470, 16.8563,  7.7435, 44.7048])
Traffic light set to phase 0 for 31.847043991088867 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 16.85633087158203 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 7.74350643157959 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 44.70481872558594 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 6 needed: 128
optimize model
Total experiences in memory: 7
Action Durations at step 1098: tensor([15.4651, 55.3186, 38.8826, 45.2767])
Traffic light set to phase 0 for 15.465092658996582 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 55.3186149597168 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 38.88263702392578 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 45.27668380737305 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 7 needed: 128
optimize model
Total experiences in memory: 8
Action Durations at step 1295: tensor([32.4295, 36.7730, 50.1044,  5.4637])
Traffic light set to phase 0 for 32.42945861816406 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 36.773048400878906 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 50.1043701171875 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 5.46366024017334 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 8 needed: 128
optimize model
Total experiences in memory: 9
Action Durations at step 1462: tensor([18.1952,  8.7671, 17.0690, 50.9650])
Traffic light set to phase 0 for 18.195194244384766 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 8.76709270477295 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 17.069000244140625 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 50.96501541137695 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 9 needed: 128
optimize model
Total experiences in memory: 10
Action Durations at step 1599: tensor([56.1638, 38.5873, 51.4924, 26.8260])
Traffic light set to phase 0 for 56.16376495361328 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 38.587310791015625 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 51.49235916137695 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 26.82602882385254 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 10 needed: 128
optimize model
Total experiences in memory: 11
Action Durations at step 1814: tensor([ 7.6570, 32.8232, 49.8987, 19.1962])
Traffic light set to phase 0 for 7.656973838806152 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 32.823150634765625 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 49.898681640625 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 19.196155548095703 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 11 needed: 128
optimize model
Total experiences in memory: 12
Action Durations at step 1965: tensor([15.1617, 47.3737, 33.8807, 40.0573])
Traffic light set to phase 0 for 15.161684036254883 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 47.37372970581055 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 33.88069534301758 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 40.05729675292969 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 12 needed: 128
optimize model
Total experiences in memory: 13
Action Durations at step 2144: tensor([25.6555, 35.2184, 49.7058, 14.9796])
Traffic light set to phase 0 for 25.655513763427734 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 35.21836471557617 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 49.705814361572266 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 14.97956657409668 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 13 needed: 128
optimize model
Total experiences in memory: 14
Action Durations at step 2311: tensor([45.9432, 58.4522, 17.1913, 46.4345])
Traffic light set to phase 0 for 45.94316101074219 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 58.4521598815918 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 17.19129180908203 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 46.434513092041016 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 14 needed: 128
optimize model
Total experiences in memory: 15
Action Durations at step 2521: tensor([50.6277, 56.4307, 30.8416, 18.8346])
Traffic light set to phase 0 for 50.627685546875 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 56.430728912353516 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 30.841596603393555 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 18.8345947265625 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 15 needed: 128
optimize model
Total experiences in memory: 16
Action Durations at step 2719: tensor([44.6754, 46.0455, 48.0450, 50.5830])
Traffic light set to phase 0 for 44.67544174194336 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 46.04549789428711 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 48.04501724243164 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 50.58304214477539 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 16 needed: 128
optimize model
Total experiences in memory: 17
Action Durations at step 2951: tensor([53.2950, 13.4298, 20.6127, 36.7943])
Traffic light set to phase 0 for 53.29495620727539 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 13.429840087890625 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 20.612674713134766 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 36.794273376464844 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 17 needed: 128
optimize model
Total experiences in memory: 18
Action Durations at step 3117: tensor([53.2208, 19.5540, 20.5033, 26.6816])
Traffic light set to phase 0 for 53.22076416015625 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 19.554044723510742 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 20.503265380859375 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 26.681577682495117 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 18 needed: 128
optimize model
Total experiences in memory: 19
Action Durations at step 3279: tensor([ 5.5611, 47.2336, 13.5953, 50.8150])
Traffic light set to phase 0 for 5.561063766479492 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 47.23357009887695 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 13.595296859741211 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 50.81501770019531 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 19 needed: 128
optimize model
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 89, in <module>
    print(f'loss in epsiode {episode}',Simulation.loss_store[episode])
IndexError: list index out of range
Total experiences in memory: 20
Action Durations at step 3438: tensor([12.4637,  9.7605, 14.4715, 38.1753])
Traffic light set to phase 0 for 12.463726043701172 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 9.760499000549316 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 14.4714994430542 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 38.17525863647461 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 20 needed: 128
optimize model
Total experiences in memory: 21
Action Durations at step 3555: tensor([30.4301, 10.9539, 54.1299, 44.2010])
Traffic light set to phase 0 for 30.430076599121094 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 10.953911781311035 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 54.129878997802734 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 44.2010498046875 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 21 needed: 128
optimize model
epsilon : 1.000
queue length in epsiode 0 0.04094193203104094