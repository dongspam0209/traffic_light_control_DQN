episode 0
Simulating
Action Durations at step 0: tensor([57.4711, 41.4416, 59.3227, 16.5821])
Traffic light set to phase 0 for 57.471126556396484 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 41.44155502319336 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 59.32272720336914 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 16.582077026367188 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 0
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 1
Action Durations at step 217: tensor([17.1724, 38.2594,  8.7784,  7.7512])
Traffic light set to phase 0 for 17.172447204589844 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 38.259437561035156 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 8.778360366821289 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 7.751177787780762 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 1
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 2
Action Durations at step 331: tensor([37.5915, 27.5182, 18.9941, 30.8229])
Traffic light set to phase 0 for 37.591522216796875 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 27.518150329589844 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 18.994140625 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 30.82293701171875 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 2
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 3
Action Durations at step 487: tensor([54.8307,  9.2983,  5.2868, 17.5406])
Traffic light set to phase 0 for 54.8306999206543 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 9.298294067382812 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 5.286827564239502 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 17.540565490722656 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 3
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 4
Action Durations at step 616: tensor([56.0353, 43.3945, 36.3964,  7.2218])
Traffic light set to phase 0 for 56.035308837890625 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 43.3945426940918 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 36.39640808105469 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 7.221785068511963 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 4
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 5
Action Durations at step 802: tensor([52.2557, 24.2693, 20.8232, 33.3142])
Traffic light set to phase 0 for 52.255733489990234 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 24.269254684448242 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 20.823152542114258 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 33.314239501953125 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 5
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 6
Action Durations at step 975: tensor([46.5606, 47.7781, 14.2660, 14.6605])
Traffic light set to phase 0 for 46.560577392578125 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 47.7780876159668 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 14.266048431396484 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 14.660454750061035 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 6
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 7
Action Durations at step 1140: tensor([49.1134, 35.6007, 40.5094, 59.8438])
Traffic light set to phase 0 for 49.1133918762207 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 35.600669860839844 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 40.5094108581543 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 59.84376907348633 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 7
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 8
Action Durations at step 1367: tensor([51.7166, 18.3143, 24.2504, 11.8367])
Traffic light set to phase 0 for 51.71661376953125 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 18.314289093017578 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 24.250394821166992 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 11.83669376373291 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 8
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 9
Action Durations at step 1515: tensor([27.4676, 24.9447, 34.9875, 38.8643])
Traffic light set to phase 0 for 27.467565536499023 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 24.944656372070312 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 34.98750305175781 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 38.86433792114258 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 9
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 10
Action Durations at step 1682: tensor([17.1302, 13.4374,  9.6576, 16.7934])
Traffic light set to phase 0 for 17.130229949951172 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 13.437445640563965 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 9.657577514648438 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 16.793445587158203 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 10
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 11
Action Durations at step 1781: tensor([29.3837, 42.8048, 12.2608, 41.8307])
Traffic light set to phase 0 for 29.383699417114258 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 42.80482864379883 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 12.260785102844238 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 41.83070373535156 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 11
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 12
Action Durations at step 1949: tensor([54.0614, 32.1853, 24.9312, 13.1437])
Traffic light set to phase 0 for 54.061405181884766 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 32.185272216796875 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 24.931150436401367 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 13.143678665161133 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 12
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 13
Action Durations at step 2116: tensor([43.1170, 42.5265, 10.1504, 20.9855])
Traffic light set to phase 0 for 43.117042541503906 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 42.52647399902344 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 10.150444030761719 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 20.985475540161133 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 13
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 14
Action Durations at step 2275: tensor([44.8640, 16.9636, 20.5068, 57.7398])
Traffic light set to phase 0 for 44.86399459838867 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 16.963600158691406 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 20.506813049316406 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 57.73976135253906 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 14
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 15
Action Durations at step 2456: tensor([ 7.9184, 45.5973, 39.9260, 54.7413])
Traffic light set to phase 0 for 7.918395042419434 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 45.59729766845703 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 39.92597961425781 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 54.7413444519043 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 15
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 16
Action Durations at step 2645: tensor([22.6130,  8.7241, 12.4481, 27.9043])
Traffic light set to phase 0 for 22.61298179626465 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 8.724114418029785 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 12.448081970214844 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 27.90430450439453 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 16
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 17
Action Durations at step 2758: tensor([52.3798, 15.6760, 16.1252, 50.9755])
Traffic light set to phase 0 for 52.37982940673828 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 15.675950050354004 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 16.125152587890625 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 50.97548294067383 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 17
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 18
Action Durations at step 2935: tensor([ 5.6394, 46.5591, 19.3066, 33.6080])
Traffic light set to phase 0 for 5.639377593994141 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 46.55908203125 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 19.30664825439453 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 33.608001708984375 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 18
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 19
Action Durations at step 3082: tensor([56.5834, 34.1132, 20.6877, 11.4358])
Traffic light set to phase 0 for 56.58343505859375 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 34.113189697265625 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 20.68766212463379 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 11.435782432556152 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 19
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 20
Action Durations at step 3247: tensor([33.5813,  5.6959, 55.1502, 35.9719])
Traffic light set to phase 0 for 33.58126449584961 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 5.695911407470703 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 55.15020751953125 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 35.97191619873047 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 20
No loss recorded for episode 0
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 21
Action Durations at step 3419: tensor([25.7031, 41.9079, 49.3217, 56.7824])
Traffic light set to phase 0 for 25.703113555908203 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 41.90788650512695 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 49.321720123291016 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 56.78235626220703 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 21
No loss recorded for episode 0
epsilon : 1.000
queue length in epsiode 0 0.05476059438635113
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 89, in <module>
    print(f'loss in epsiode {episode}',Simulation.loss_store[episode])
IndexError: list index out of range