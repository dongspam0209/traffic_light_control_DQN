episode 0
Simulating
Action Durations at step 0: [44.071571350097656, 40.3037223815918, 7.207236289978027, 52.85694122314453]
Traffic light set to phase 0 for 44.071571350097656 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 40.3037223815918 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 7.207236289978027 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 52.85694122314453 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 1
Action Durations at step 187: [30.075565338134766, 56.78129959106445, 23.655977249145508, 7.693795204162598]
Traffic light set to phase 0 for 30.075565338134766 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 56.78129959106445 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 23.655977249145508 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 7.693795204162598 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 2
Action Durations at step 347: [22.821964263916016, 15.587834358215332, 31.23848533630371, 46.95380401611328]
Traffic light set to phase 0 for 22.821964263916016 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 15.587834358215332 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 31.23848533630371 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 46.95380401611328 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 3
Action Durations at step 505: [33.68080139160156, 6.917622089385986, 5.603025436401367, 21.003236770629883]
Traffic light set to phase 0 for 33.68080139160156 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 6.917622089385986 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 5.603025436401367 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 21.003236770629883 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 4
Action Durations at step 614: [8.832188606262207, 28.492956161499023, 54.49570083618164, 5.020849704742432]
Traffic light set to phase 0 for 8.832188606262207 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 28.492956161499023 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 54.49570083618164 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 5.020849704742432 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 5
Action Durations at step 753: [57.37321090698242, 28.420013427734375, 59.61176300048828, 11.720308303833008]
Traffic light set to phase 0 for 57.37321090698242 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 28.420013427734375 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 59.61176300048828 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 11.720308303833008 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 6
Action Durations at step 952: [12.750631332397461, 27.97270965576172, 44.00937271118164, 33.72703170776367]
Traffic light set to phase 0 for 12.750631332397461 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 27.97270965576172 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 44.00937271118164 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 33.72703170776367 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 7
Action Durations at step 1112: [11.157337188720703, 44.121498107910156, 22.019168853759766, 49.66352462768555]
Traffic light set to phase 0 for 11.157337188720703 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 44.121498107910156 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 22.019168853759766 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 49.66352462768555 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 8
Action Durations at step 1282: [37.97246551513672, 45.02374267578125, 26.542810440063477, 57.12963104248047]
Traffic light set to phase 0 for 37.97246551513672 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 45.02374267578125 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 26.542810440063477 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 57.12963104248047 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 9
Action Durations at step 1491: [8.320220947265625, 53.64630126953125, 43.088130950927734, 45.30838394165039]
Traffic light set to phase 0 for 8.320220947265625 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 53.64630126953125 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 43.088130950927734 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 45.30838394165039 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 10
Action Durations at step 1684: [7.708681583404541, 17.51241683959961, 19.339920043945312, 16.989933013916016]
Traffic light set to phase 0 for 7.708681583404541 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 17.51241683959961 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 19.339920043945312 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 16.989933013916016 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 11
Action Durations at step 1787: [40.304588317871094, 53.59421157836914, 45.428409576416016, 56.640411376953125]
Traffic light set to phase 0 for 40.304588317871094 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 53.59421157836914 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 45.428409576416016 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 56.640411376953125 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 12
Action Durations at step 2025: [37.59270095825195, 41.3613166809082, 55.22277069091797, 54.25389099121094]
Traffic light set to phase 0 for 37.59270095825195 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 41.3613166809082 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 55.22277069091797 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 54.25389099121094 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 13
Action Durations at step 2256: [35.56562423706055, 48.45881271362305, 32.829505920410156, 48.97398376464844]
Traffic light set to phase 0 for 35.56562423706055 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 48.45881271362305 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 32.829505920410156 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 48.97398376464844 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 14
Action Durations at step 2463: [19.801982879638672, 14.872901916503906, 21.073728561401367, 54.055267333984375]
Traffic light set to phase 0 for 19.801982879638672 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 14.872901916503906 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 21.073728561401367 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 54.055267333984375 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 15
Action Durations at step 2615: [30.076316833496094, 22.544466018676758, 58.59161376953125, 54.084354400634766]
Traffic light set to phase 0 for 30.076316833496094 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 22.544466018676758 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 58.59161376953125 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 54.084354400634766 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 16
Action Durations at step 2823: [25.914518356323242, 13.207023620605469, 15.729510307312012, 57.807472229003906]
Traffic light set to phase 0 for 25.914518356323242 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 13.207023620605469 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 15.729510307312012 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 57.807472229003906 seconds.
Traffic light set to phase 7 for 10 seconds.
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 87, in <module>
    Simulation.run(episode,epsilon)
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 199, in run
    self.optimize_model()
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 313, in optimize_model
    action_batch = torch.cat(batch.action).view(BATCH_SIZE, 1).to(device)  # Ensure this is [16, 1]
RuntimeError: shape '[16, 1]' is invalid for input of size 64