episode 0
Simulating
Action Durations at step 0: tensor([59.4194,  9.3746, 57.8938,  5.8245])
Traffic light set to phase 0 for 59.41936111450195 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 9.374635696411133 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 57.89384078979492 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 5.824520587921143 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 0 needed: 128
optimize model
Total experiences in memory: 1
Action Durations at step 174: tensor([ 9.0554, 57.7995,  6.3736, 36.2787])
Traffic light set to phase 0 for 9.055395126342773 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 57.79949951171875 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 6.37357234954834 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 36.27873611450195 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 1 needed: 128
optimize model
Total experiences in memory: 2
Action Durations at step 326: tensor([ 8.7932, 58.5631, 43.4085, 29.5750])
Traffic light set to phase 0 for 8.793213844299316 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 58.56305694580078 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 43.40851974487305 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 29.575042724609375 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 2 needed: 128
optimize model
Total experiences in memory: 3
Action Durations at step 508: tensor([27.5425, 52.8035, 35.9106, 12.1471])
Traffic light set to phase 0 for 27.542524337768555 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 52.80352020263672 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 35.910614013671875 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 12.147125244140625 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 3 needed: 128
optimize model
Total experiences in memory: 4
Action Durations at step 678: tensor([19.5400,  5.4900, 27.0787, 48.3596])
Traffic light set to phase 0 for 19.539966583251953 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 5.489971160888672 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 27.078657150268555 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 48.35957717895508 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 4 needed: 128
optimize model
Total experiences in memory: 5
Action Durations at step 821: tensor([13.7199, 15.9610, 48.2221, 26.0440])
Traffic light set to phase 0 for 13.71993637084961 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 15.961030960083008 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 48.22213363647461 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 26.0439510345459 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 5 needed: 128
optimize model
Total experiences in memory: 6
Action Durations at step 967: tensor([45.1109, 14.3614,  7.3319, 14.6240])
Traffic light set to phase 0 for 45.11093521118164 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 14.361356735229492 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 7.3318986892700195 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 14.623993873596191 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 6 needed: 128
optimize model
Total experiences in memory: 7
Action Durations at step 1091: tensor([34.3393, 48.3710, 34.8930, 41.6265])
Traffic light set to phase 0 for 34.33930969238281 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 48.37103271484375 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 34.892974853515625 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 41.62650680541992 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 7 needed: 128
optimize model
Total experiences in memory: 8
Action Durations at step 1292: tensor([13.2234, 13.5743, 34.0794, 17.1550])
Traffic light set to phase 0 for 13.223372459411621 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 13.574254035949707 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 34.07939147949219 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 17.155046463012695 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 8 needed: 128
optimize model
Total experiences in memory: 9
Action Durations at step 1413: tensor([27.4214, 37.7719,  8.2862, 55.3956])
Traffic light set to phase 0 for 27.421369552612305 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 37.7718505859375 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 8.286172866821289 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 55.39557647705078 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 9 needed: 128
optimize model
Total experiences in memory: 10
Action Durations at step 1584: tensor([37.4603, 50.5318, 29.4552, 30.0117])
Traffic light set to phase 0 for 37.46034240722656 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 50.531761169433594 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 29.45516586303711 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 30.011659622192383 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 10 needed: 128
optimize model
Total experiences in memory: 11
Action Durations at step 1774: tensor([37.3263, 44.9534, 15.3622, 28.2375])
Traffic light set to phase 0 for 37.32625961303711 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 44.95344543457031 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 15.362188339233398 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 28.237451553344727 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 11 needed: 128
optimize model
Total experiences in memory: 12
Action Durations at step 1942: tensor([27.7684, 53.1655, 22.7754,  8.5332])
Traffic light set to phase 0 for 27.768434524536133 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 53.165504455566406 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 22.77536964416504 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 8.533156394958496 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 12 needed: 128
optimize model
Total experiences in memory: 13
Action Durations at step 2096: tensor([ 8.5375, 50.4841, 55.6781, 40.1446])
Traffic light set to phase 0 for 8.537469863891602 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 50.48408508300781 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 55.67814636230469 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 40.14460754394531 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 13 needed: 128
optimize model
Total experiences in memory: 14
Action Durations at step 2293: tensor([53.6573, 44.1549, 17.2270, 47.2991])
Traffic light set to phase 0 for 53.657291412353516 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 44.154911041259766 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 17.22704315185547 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 47.29905319213867 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 14 needed: 128
optimize model
Total experiences in memory: 15
Action Durations at step 2498: tensor([51.1523, 28.4490, 15.6618, 36.6391])
Traffic light set to phase 0 for 51.152347564697266 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 28.448993682861328 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 15.661844253540039 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 36.639068603515625 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 15 needed: 128
optimize model
Total experiences in memory: 16
Action Durations at step 2672: tensor([53.7998, 13.0699, 17.7216, 59.8106])
Traffic light set to phase 0 for 53.7997932434082 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 13.069933891296387 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 17.72161865234375 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 59.81062316894531 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 16 needed: 128
optimize model
Total experiences in memory: 17
Action Durations at step 2858: tensor([37.0784, 51.5159, 45.3292, 59.0787])
Traffic light set to phase 0 for 37.07839584350586 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 51.51585388183594 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 45.32917022705078 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 59.07867431640625 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 17 needed: 128
optimize model
Total experiences in memory: 18
Action Durations at step 3094: tensor([41.8559, 10.3574, 16.8986, 32.6783])
Traffic light set to phase 0 for 41.85588836669922 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 10.35737419128418 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 16.898624420166016 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 32.67831802368164 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 18 needed: 128
optimize model
Total experiences in memory: 19
Action Durations at step 3237: tensor([40.6719, 24.5307, 28.2909, 19.6533])
Traffic light set to phase 0 for 40.671905517578125 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 24.530712127685547 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 28.29094696044922 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 19.653297424316406 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 19 needed: 128
optimize model
Total experiences in memory: 20
Action Durations at step 3392: tensor([57.8647, 34.4725, 47.2498, 44.5393])
Traffic light set to phase 0 for 57.86465072631836 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 34.47245407104492 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 47.24983215332031 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 44.539329528808594 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 20 needed: 128
optimize model
epsilon : 1.000
queue length in epsiode 0 0.05472636815920398
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 89, in <module>
    print(f'loss in epsiode {episode}',Simulation.loss_store[episode])
IndexError: list index out of range