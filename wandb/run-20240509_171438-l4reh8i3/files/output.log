episode 0
Simulating
Action Durations at step 0: tensor([11.0152, 50.6245, 35.1814, 58.0443])
Traffic light set to phase 0 for 11.01522159576416 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 50.624542236328125 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 35.181392669677734 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 58.044281005859375 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 0 needed: 16
optimize model
Total experiences in memory: 1
Action Durations at step 198: tensor([35.5042, 55.2662, 34.1764, 25.3017])
Traffic light set to phase 0 for 35.504180908203125 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 55.26615905761719 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 34.176353454589844 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 25.301727294921875 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 1 needed: 16
optimize model
Total experiences in memory: 2
Action Durations at step 391: tensor([27.2643, 14.0491, 20.1552, 32.9560])
Traffic light set to phase 0 for 27.26427459716797 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 14.049145698547363 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 20.155241012573242 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 32.95598602294922 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 2 needed: 16
optimize model
Total experiences in memory: 3
Action Durations at step 528: tensor([25.1836, 35.0098, 32.8565, 38.7010])
Traffic light set to phase 0 for 25.183605194091797 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 35.00982666015625 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 32.85652160644531 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 38.70095443725586 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 3 needed: 16
optimize model
Total experiences in memory: 4
Action Durations at step 702: tensor([57.3689, 56.1245, 35.9243, 14.9128])
Traffic light set to phase 0 for 57.368896484375 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 56.12453842163086 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 35.924259185791016 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 14.912788391113281 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 4 needed: 16
optimize model
Total experiences in memory: 5
Action Durations at step 908: tensor([17.3759, 55.0919, 36.6318, 25.6478])
Traffic light set to phase 0 for 17.375946044921875 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 55.09191131591797 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 36.63178253173828 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 25.64781951904297 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 5 needed: 16
optimize model
Total experiences in memory: 6
Action Durations at step 1085: tensor([11.1182, 56.1987, 25.9189, 54.5717])
Traffic light set to phase 0 for 11.118244171142578 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 56.19866180419922 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 25.91887855529785 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 54.57170104980469 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 6 needed: 16
optimize model
Total experiences in memory: 7
Action Durations at step 1275: tensor([25.6210, 11.7983, 44.0129, 29.4251])
Traffic light set to phase 0 for 25.620990753173828 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 11.798324584960938 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 44.012935638427734 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 29.425094604492188 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 7 needed: 16
optimize model
Total experiences in memory: 8
Action Durations at step 1428: tensor([39.9011, 17.8869, 33.1596, 20.6192])
Traffic light set to phase 0 for 39.90114212036133 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 17.886917114257812 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 33.159629821777344 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 20.619243621826172 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 8 needed: 16
optimize model
Total experiences in memory: 9
Action Durations at step 1581: tensor([50.1248, 58.4177, 31.2662,  8.2705])
Traffic light set to phase 0 for 50.12478256225586 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 58.41771697998047 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 31.266189575195312 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 8.270538330078125 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 9 needed: 16
optimize model
Total experiences in memory: 10
Action Durations at step 1772: tensor([42.7564,  7.5714, 15.6965, 29.5206])
Traffic light set to phase 0 for 42.756351470947266 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 7.571391582489014 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 15.696540832519531 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 29.52064323425293 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 10 needed: 16
optimize model
Total experiences in memory: 11
Action Durations at step 1909: tensor([40.4471, 37.4837, 21.9300, 24.5298])
Traffic light set to phase 0 for 40.44705581665039 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 37.483734130859375 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 21.930025100708008 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 24.52983283996582 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 11 needed: 16
optimize model
Total experiences in memory: 12
Action Durations at step 2075: tensor([26.6628,  8.1410, 35.5116, 20.2337])
Traffic light set to phase 0 for 26.66277503967285 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 8.141044616699219 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 35.511634826660156 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 20.23370933532715 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 12 needed: 16
optimize model
Total experiences in memory: 13
Action Durations at step 2208: tensor([22.8789, 45.2610,  6.1365, 34.0806])
Traffic light set to phase 0 for 22.878881454467773 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 45.260990142822266 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 6.136463165283203 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 34.080562591552734 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 13 needed: 16
optimize model
Total experiences in memory: 14
Action Durations at step 2359: tensor([55.9834, 30.1751, 36.1255,  5.3810])
Traffic light set to phase 0 for 55.98340606689453 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 30.17513084411621 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 36.125484466552734 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 5.380989074707031 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 14 needed: 16
optimize model
Total experiences in memory: 15
Action Durations at step 2529: tensor([41.4235, 21.1502, 24.4088, 44.6442])
Traffic light set to phase 0 for 41.423545837402344 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 21.150230407714844 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 24.408845901489258 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 44.644222259521484 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Not enough experiences: 15 needed: 16
optimize model
Total experiences in memory: 16
Action Durations at step 2703: tensor([24.4944,  8.9635, 55.0849, 46.1208])
Traffic light set to phase 0 for 24.494407653808594 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 8.963499069213867 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 55.0849494934082 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 46.120819091796875 seconds.
Traffic light set to phase 7 for 10 seconds.
Optimizing Model...
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 87, in <module>
    Simulation.run(episode,epsilon)
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 197, in run
    self.optimize_model()
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 325, in optimize_model
    q_eval = self.policy_net(state_batch).gather(1, action_batch.unsqueeze(1).long())
RuntimeError: Size does not match at dimension 0 expected index [64, 1] to be smaller than self [16, 4] apart from dimension 1