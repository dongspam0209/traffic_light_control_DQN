episode 0
Simulating
Action Durations at step 0: [20.800168991088867, 36.61227035522461, 23.313209533691406, 49.82075119018555]
Traffic light set to phase 0 for 20.800168991088867 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 36.61227035522461 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 23.313209533691406 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 49.82075119018555 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 1
Action Durations at step 172: [15.629388809204102, 50.28472900390625, 55.114524841308594, 34.502403259277344]
Traffic light set to phase 0 for 15.629388809204102 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 50.28472900390625 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 55.114524841308594 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 34.502403259277344 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 2
Action Durations at step 370: [42.32073974609375, 30.89900779724121, 44.329185485839844, 30.502761840820312]
Traffic light set to phase 0 for 42.32073974609375 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 30.89900779724121 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 44.329185485839844 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 30.502761840820312 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 3
Action Durations at step 560: [37.34405517578125, 10.81736946105957, 5.077592849731445, 39.195316314697266]
Traffic light set to phase 0 for 37.34405517578125 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 10.81736946105957 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 5.077592849731445 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 39.195316314697266 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 4
Action Durations at step 695: [12.733585357666016, 30.39491081237793, 19.477832794189453, 53.41714096069336]
Traffic light set to phase 0 for 12.733585357666016 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 30.39491081237793 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 19.477832794189453 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 53.41714096069336 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 5
Action Durations at step 853: [29.993547439575195, 30.389240264892578, 49.4440803527832, 21.856359481811523]
Traffic light set to phase 0 for 29.993547439575195 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 30.389240264892578 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 49.4440803527832 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 21.856359481811523 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 6
Action Durations at step 1026: [39.91017150878906, 13.472572326660156, 48.44374465942383, 56.53229522705078]
Traffic light set to phase 0 for 39.91017150878906 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 13.472572326660156 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 48.44374465942383 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 56.53229522705078 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 7
Action Durations at step 1226: [23.754640579223633, 41.907493591308594, 9.390098571777344, 46.3830680847168]
Traffic light set to phase 0 for 23.754640579223633 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 41.907493591308594 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 9.390098571777344 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 46.3830680847168 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 8
Action Durations at step 1389: [58.5529899597168, 11.95832633972168, 6.111961364746094, 39.35465621948242]
Traffic light set to phase 0 for 58.5529899597168 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 11.95832633972168 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 6.111961364746094 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 39.35465621948242 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 9
Action Durations at step 1547: [57.33778381347656, 5.956149101257324, 9.562505722045898, 56.36573791503906]
Traffic light set to phase 0 for 57.33778381347656 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 5.956149101257324 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 9.562505722045898 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 56.36573791503906 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 10
Action Durations at step 1718: [17.312992095947266, 20.657302856445312, 17.159400939941406, 38.63568878173828]
Traffic light set to phase 0 for 17.312992095947266 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 20.657302856445312 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 17.159400939941406 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 38.63568878173828 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 11
Action Durations at step 1854: [43.214149475097656, 44.70832443237305, 10.46359634399414, 57.4234619140625]
Traffic light set to phase 0 for 43.214149475097656 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 44.70832443237305 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 10.46359634399414 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 57.4234619140625 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 12
Action Durations at step 2052: [11.820128440856934, 46.30125045776367, 30.069557189941406, 31.21198272705078]
Traffic light set to phase 0 for 11.820128440856934 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 46.30125045776367 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 30.069557189941406 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 31.21198272705078 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 13
Action Durations at step 2214: [23.61845588684082, 55.32551193237305, 51.37579345703125, 17.392311096191406]
Traffic light set to phase 0 for 23.61845588684082 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 55.32551193237305 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 51.37579345703125 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 17.392311096191406 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 14
Action Durations at step 2404: [36.87721252441406, 18.250761032104492, 45.342140197753906, 37.55121612548828]
Traffic light set to phase 0 for 36.87721252441406 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 18.250761032104492 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 45.342140197753906 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 37.55121612548828 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 15
Action Durations at step 2584: [24.433189392089844, 38.7703857421875, 55.91220474243164, 18.304828643798828]
Traffic light set to phase 0 for 24.433189392089844 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 38.7703857421875 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 55.91220474243164 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 18.304828643798828 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 16
Action Durations at step 2763: [22.282283782958984, 23.206871032714844, 23.485319137573242, 10.776456832885742]
Traffic light set to phase 0 for 22.282283782958984 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 23.206871032714844 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 23.485319137573242 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 10.776456832885742 seconds.
Traffic light set to phase 7 for 10 seconds.
Current Q-values shape: torch.Size([16, 4])
Action indices shape: torch.Size([16, 4, 1])
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 87, in <module>
    Simulation.run(episode,epsilon)
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 199, in run
    self.optimize_model()
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 324, in optimize_model
    action_q_values = current_q_values.gather(1, action_indices).squeeze(-1)
RuntimeError: Index tensor must have the same number of dimensions as input tensor