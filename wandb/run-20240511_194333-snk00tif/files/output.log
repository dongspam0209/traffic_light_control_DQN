
episode 0
Simulating
Action Durations at step 0: [28.59726905822754, 30.889829635620117, 25.579713821411133, 25.664649963378906]
Traffic light set to phase 0 for 28.59726905822754 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 30.889829635620117 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 25.579713821411133 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 25.664649963378906 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 1
Action Durations at step 152: [20.97802734375, 27.69186782836914, 14.187858581542969, 45.23444747924805]
Traffic light set to phase 0 for 20.97802734375 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 27.69186782836914 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 14.187858581542969 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 45.23444747924805 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 2
Action Durations at step 302: [10.070032119750977, 11.507078170776367, 43.37065505981445, 31.23948097229004]
Traffic light set to phase 0 for 10.070032119750977 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 11.507078170776367 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 43.37065505981445 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 31.23948097229004 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 3
Action Durations at step 441: [16.19896697998047, 58.93191909790039, 53.17530822753906, 54.99005889892578]
Traffic light set to phase 0 for 16.19896697998047 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 58.93191909790039 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 53.17530822753906 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 54.99005889892578 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 4
Action Durations at step 666: [50.24048614501953, 38.87665557861328, 11.875701904296875, 13.684767723083496]
Traffic light set to phase 0 for 50.24048614501953 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 38.87665557861328 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 11.875701904296875 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 13.684767723083496 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 5
Action Durations at step 822: [17.01336097717285, 51.00290298461914, 47.014739990234375, 23.304834365844727]
Traffic light set to phase 0 for 17.01336097717285 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 51.00290298461914 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 47.014739990234375 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 23.304834365844727 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 6
Action Durations at step 1004: [20.801637649536133, 52.178565979003906, 22.006284713745117, 56.742271423339844]
Traffic light set to phase 0 for 20.801637649536133 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 52.178565979003906 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 22.006284713745117 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 56.742271423339844 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 7
Action Durations at step 1198: [50.28009033203125, 43.83277130126953, 28.781885147094727, 55.857818603515625]
Traffic light set to phase 0 for 50.28009033203125 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 43.83277130126953 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 28.781885147094727 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 55.857818603515625 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 8
Action Durations at step 1418: [23.46466827392578, 53.41533660888672, 8.782546043395996, 52.797462463378906]
Traffic light set to phase 0 for 23.46466827392578 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 53.41533660888672 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 8.782546043395996 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 52.797462463378906 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 9
Action Durations at step 1598: [22.394269943237305, 36.476375579833984, 8.362975120544434, 12.642704963684082]
Traffic light set to phase 0 for 22.394269943237305 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 36.476375579833984 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 8.362975120544434 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 12.642704963684082 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 10
Action Durations at step 1720: [35.99213790893555, 33.012351989746094, 46.244537353515625, 58.90216827392578]
Traffic light set to phase 0 for 35.99213790893555 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 33.012351989746094 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 46.244537353515625 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 58.90216827392578 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 11
Action Durations at step 1936: [9.01024055480957, 45.65671920776367, 53.54551315307617, 47.73979568481445]
Traffic light set to phase 0 for 9.01024055480957 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 45.65671920776367 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 53.54551315307617 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 47.73979568481445 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 12
Action Durations at step 2134: [27.264917373657227, 28.102876663208008, 30.674772262573242, 30.56084632873535]
Traffic light set to phase 0 for 27.264917373657227 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 28.102876663208008 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 30.674772262573242 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 30.56084632873535 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 13
Action Durations at step 2293: [21.725069046020508, 34.0423469543457, 55.39873123168945, 55.56044387817383]
Traffic light set to phase 0 for 21.725069046020508 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 34.0423469543457 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 55.39873123168945 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 55.56044387817383 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 14
Action Durations at step 2502: [11.53177261352539, 6.572277545928955, 48.936317443847656, 38.54962158203125]
Traffic light set to phase 0 for 11.53177261352539 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 6.572277545928955 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 48.936317443847656 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 38.54962158203125 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 15
Action Durations at step 2649: [10.615739822387695, 56.21508026123047, 48.55905532836914, 53.30281066894531]
Traffic light set to phase 0 for 10.615739822387695 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 56.21508026123047 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 48.55905532836914 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 53.30281066894531 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 16
Action Durations at step 2860: [13.510852813720703, 56.71358871459961, 11.195682525634766, 43.860923767089844]
Traffic light set to phase 0 for 13.510852813720703 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 56.71358871459961 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 11.195682525634766 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 43.860923767089844 seconds.
Traffic light set to phase 7 for 10 seconds.
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 87, in <module>
    Simulation.run(episode,epsilon)
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 199, in run
    self.optimize_model()
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 306, in optimize_model
    action_q_values = current_q_values.gather(1, action_batch).mean(dim=1)  # 각 배치마다 액션 인덱스를 사용하여 Q 값을 추출하고 평균 계산
RuntimeError: index 20 is out of bounds for dimension 1 with size 4