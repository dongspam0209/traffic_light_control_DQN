episode 0
Simulating
Action Durations at step 0: tensor([48.3550, 40.5082, 16.8127,  5.8303])
Traffic light set to phase 0 for 48.35504913330078 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 40.50822448730469 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 16.81266212463379 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 5.830319881439209 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 1
Action Durations at step 153: tensor([24.6112, 54.8689, 31.3854, 54.1671])
Traffic light set to phase 0 for 24.61121940612793 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 54.868892669677734 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 31.385356903076172 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 54.1671142578125 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 2
Action Durations at step 360: tensor([47.5442,  8.5857, 43.6630, 14.6671])
Traffic light set to phase 0 for 47.54417419433594 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 8.585651397705078 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 43.66299057006836 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 14.667054176330566 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 3
Action Durations at step 516: tensor([47.2575, 32.3558, 27.3487,  8.4559])
Traffic light set to phase 0 for 47.25751876831055 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 32.355796813964844 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 27.34868049621582 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 8.45587158203125 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 4
Action Durations at step 674: tensor([12.5719, 19.0473, 47.1468, 33.2851])
Traffic light set to phase 0 for 12.571882247924805 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 19.047334671020508 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 47.14683532714844 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 33.285133361816406 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 5
Action Durations at step 829: tensor([43.3893, 50.0519,  9.8872, 15.8788])
Traffic light set to phase 0 for 43.38928985595703 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 50.051902770996094 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 9.887189865112305 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 15.878769874572754 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 6
Action Durations at step 990: tensor([48.0357, 58.9522, 26.4638, 10.2711])
Traffic light set to phase 0 for 48.035667419433594 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 58.952186584472656 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 26.463790893554688 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 10.271133422851562 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 7
Action Durations at step 1176: tensor([55.7152, 52.4307, 49.0733, 34.6328])
Traffic light set to phase 0 for 55.715213775634766 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 52.4306640625 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 49.07332229614258 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 34.63277816772461 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 8
Action Durations at step 1410: tensor([10.9281,  9.0044, 47.9953, 47.2534])
Traffic light set to phase 0 for 10.928056716918945 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 9.00441837310791 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 47.99531555175781 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 47.25343704223633 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 9
Action Durations at step 1567: tensor([16.8622,  5.6087, 30.6954, 28.7479])
Traffic light set to phase 0 for 16.862194061279297 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 5.608696460723877 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 30.695396423339844 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 28.747920989990234 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 10
Action Durations at step 1690: tensor([57.6631, 19.1414, 13.0604, 28.0685])
Traffic light set to phase 0 for 57.66307830810547 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 19.141374588012695 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 13.060355186462402 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 28.068492889404297 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 11
Action Durations at step 1851: tensor([25.6569, 39.2587, 34.3050, 53.0153])
Traffic light set to phase 0 for 25.656850814819336 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 39.25868606567383 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 34.30500411987305 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 53.01530075073242 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 12
Action Durations at step 2046: tensor([46.9921, 39.9496, 22.1045, 28.4867])
Traffic light set to phase 0 for 46.992061614990234 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 39.94956970214844 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 22.104455947875977 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 28.48668670654297 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 13
Action Durations at step 2225: tensor([33.0139, 54.8535, 22.6352, 26.6569])
Traffic light set to phase 0 for 33.01390075683594 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 54.85353088378906 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 22.635181427001953 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 26.656925201416016 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 14
Action Durations at step 2404: tensor([31.2122,  6.3291, 15.5430, 38.4269])
Traffic light set to phase 0 for 31.21217918395996 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 6.329057216644287 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 15.543033599853516 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 38.426937103271484 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 15
Action Durations at step 2538: tensor([19.4539, 56.3729, 24.4464, 38.6681])
Traffic light set to phase 0 for 19.453916549682617 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 56.372886657714844 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 24.446395874023438 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 38.66809844970703 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 16
Action Durations at step 2719: tensor([59.7376, 13.9913, 48.2779, 17.8216])
Traffic light set to phase 0 for 59.73758316040039 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 13.991277694702148 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 48.277862548828125 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 17.821611404418945 seconds.
Traffic light set to phase 7 for 10 seconds.
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 87, in <module>
    Simulation.run(episode,epsilon)
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 197, in run
    self.optimize_model()
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 319, in optimize_model
    q_eval = q_values.gather(1, action_durations.unsqueeze(1))
RuntimeError: Index tensor must have the same number of dimensions as input tensor