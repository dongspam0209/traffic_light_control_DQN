episode 0
Simulating
Action Durations at step 0: [29.78060531616211, 11.073190689086914, 52.160892486572266, 54.7539176940918]
Traffic light set to phase 0 for 29.78060531616211 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 11.073190689086914 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 52.160892486572266 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 54.7539176940918 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 1
Action Durations at step 190: [7.94476842880249, 24.217084884643555, 45.59171676635742, 33.16307830810547]
Traffic light set to phase 0 for 7.94476842880249 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 24.217084884643555 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 45.59171676635742 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 33.16307830810547 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 2
Action Durations at step 343: [26.629545211791992, 41.14994812011719, 6.570943355560303, 37.32676696777344]
Traffic light set to phase 0 for 26.629545211791992 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 41.14994812011719 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 6.570943355560303 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 37.32676696777344 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 3
Action Durations at step 497: [33.914337158203125, 52.70412826538086, 20.40321159362793, 39.84374237060547]
Traffic light set to phase 0 for 33.914337158203125 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 52.70412826538086 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 20.40321159362793 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 39.84374237060547 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 4
Action Durations at step 685: [36.73381042480469, 45.397457122802734, 43.196678161621094, 28.223011016845703]
Traffic light set to phase 0 for 36.73381042480469 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 45.397457122802734 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 43.196678161621094 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 28.223011016845703 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 5
Action Durations at step 881: [30.442869186401367, 9.720893859863281, 9.001202583312988, 50.520347595214844]
Traffic light set to phase 0 for 30.442869186401367 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 9.720893859863281 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 9.001202583312988 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 50.520347595214844 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 6
Action Durations at step 1023: [49.640743255615234, 42.190032958984375, 24.474496841430664, 33.76344680786133]
Traffic light set to phase 0 for 49.640743255615234 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 42.190032958984375 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 24.474496841430664 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 33.76344680786133 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 7
Action Durations at step 1215: [31.222522735595703, 5.697612762451172, 29.755260467529297, 24.240140914916992]
Traffic light set to phase 0 for 31.222522735595703 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 5.697612762451172 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 29.755260467529297 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 24.240140914916992 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 8
Action Durations at step 1348: [36.80683517456055, 17.223697662353516, 46.69963836669922, 7.770043849945068]
Traffic light set to phase 0 for 36.80683517456055 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 17.223697662353516 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 46.69963836669922 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 7.770043849945068 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 9
Action Durations at step 1498: [53.665531158447266, 53.400821685791016, 28.070817947387695, 44.3847541809082]
Traffic light set to phase 0 for 53.665531158447266 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 53.400821685791016 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 28.070817947387695 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 44.3847541809082 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 10
Action Durations at step 1720: [47.964134216308594, 6.7432355880737305, 14.036803245544434, 45.762474060058594]
Traffic light set to phase 0 for 47.964134216308594 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 6.7432355880737305 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 14.036803245544434 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 45.762474060058594 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 11
Action Durations at step 1876: [13.27346134185791, 12.791784286499023, 36.52818298339844, 37.45356369018555]
Traffic light set to phase 0 for 13.27346134185791 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 12.791784286499023 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 36.52818298339844 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 37.45356369018555 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 12
Action Durations at step 2018: [56.39217758178711, 18.324413299560547, 42.93387222290039, 58.126060485839844]
Traffic light set to phase 0 for 56.39217758178711 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 18.324413299560547 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 42.93387222290039 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 58.126060485839844 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 13
Action Durations at step 2236: [59.94266891479492, 24.76349449157715, 41.03688430786133, 32.81780242919922]
Traffic light set to phase 0 for 59.94266891479492 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 24.76349449157715 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 41.03688430786133 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 32.81780242919922 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 14
Action Durations at step 2436: [23.189668655395508, 17.450332641601562, 14.242427825927734, 57.50503158569336]
Traffic light set to phase 0 for 23.189668655395508 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 17.450332641601562 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 14.242427825927734 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 57.50503158569336 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 15
Action Durations at step 2591: [58.783451080322266, 56.72523880004883, 52.50988006591797, 54.70778274536133]
Traffic light set to phase 0 for 58.783451080322266 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 56.72523880004883 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 52.50988006591797 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 54.70778274536133 seconds.
Traffic light set to phase 7 for 10 seconds.
optimize model
Total experiences in memory: 16
Action Durations at step 2855: [31.600378036499023, 25.18108558654785, 50.99424362182617, 43.33073043823242]
Traffic light set to phase 0 for 31.600378036499023 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 25.18108558654785 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 50.99424362182617 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 43.33073043823242 seconds.
Traffic light set to phase 7 for 10 seconds.
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 87, in <module>
    Simulation.run(episode,epsilon)
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 199, in run
    self.optimize_model()
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\simulation.py", line 306, in optimize_model
    action_q_values = current_q_values.gather(1, action_batch).mean(dim=1)  # 각 배치마다 액션 인덱스를 사용하여 Q 값을 추출하고 평균 계산
RuntimeError: index 29 is out of bounds for dimension 1 with size 4