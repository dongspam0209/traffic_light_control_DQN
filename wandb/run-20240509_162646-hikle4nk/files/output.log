episode 0
Simulating
Action Durations at step 0: tensor([41.0415, 21.1397, 30.0175, 48.7968])
Traffic light set to phase 0 for 41.04151916503906 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 21.139745712280273 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 30.017492294311523 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 48.79680633544922 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 1
Action Durations at step 184: tensor([51.3446, 31.0347, 27.6733, 54.4183])
Traffic light set to phase 0 for 51.34461975097656 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 31.034730911254883 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 27.673309326171875 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 54.418277740478516 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 2
Action Durations at step 391: tensor([16.0814, 42.8535,  7.6580, 56.2966])
Traffic light set to phase 0 for 16.08142852783203 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 42.85350799560547 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 7.657973289489746 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 56.29658126831055 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 3
Action Durations at step 556: tensor([32.6076, 16.5912, 48.7168, 17.4237])
Traffic light set to phase 0 for 32.60755157470703 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 16.59122657775879 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 48.716773986816406 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 17.423723220825195 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 4
Action Durations at step 713: tensor([55.3369, 12.2611, 27.8055, 21.9260])
Traffic light set to phase 0 for 55.336856842041016 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 12.261122703552246 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 27.805482864379883 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 21.925968170166016 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 5
Action Durations at step 872: tensor([18.5644, 55.3063,  7.7375, 59.7718])
Traffic light set to phase 0 for 18.564350128173828 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 55.30634307861328 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 7.737461090087891 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 59.77183151245117 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 6
Action Durations at step 1055: tensor([34.5103, 19.5685, 13.0312, 24.4004])
Traffic light set to phase 0 for 34.510337829589844 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 19.568511962890625 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 13.031244277954102 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 24.400413513183594 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 7
Action Durations at step 1189: tensor([23.0695, 46.3470, 26.2686, 38.9685])
Traffic light set to phase 0 for 23.069538116455078 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 46.34702682495117 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 26.268592834472656 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 38.968528747558594 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 8
Action Durations at step 1366: tensor([35.6346, 44.4668, 23.7478,  8.8748])
Traffic light set to phase 0 for 35.63460159301758 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 44.46677017211914 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 23.747802734375 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 8.874849319458008 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 9
Action Durations at step 1520: tensor([17.8068,  8.4904,  8.8720, 10.2119])
Traffic light set to phase 0 for 17.806804656982422 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 8.4904146194458 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 8.8720064163208 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 10.211912155151367 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 10
Action Durations at step 1607: tensor([23.7425, 34.4469, 13.9847, 34.9584])
Traffic light set to phase 0 for 23.742462158203125 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 34.446903228759766 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 13.984672546386719 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 34.95835876464844 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 11
Action Durations at step 1755: tensor([31.4361, 11.6109, 27.3668, 55.9106])
Traffic light set to phase 0 for 31.436080932617188 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 11.610906600952148 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 27.366838455200195 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 55.91058349609375 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 12
Action Durations at step 1923: tensor([13.9183, 16.1226, 20.7970, 43.1151])
Traffic light set to phase 0 for 13.918343544006348 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 16.122570037841797 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 20.797039031982422 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 43.1151237487793 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 13
Action Durations at step 2059: tensor([20.3556, 49.2377, 39.0642, 15.3514])
Traffic light set to phase 0 for 20.355649948120117 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 49.237701416015625 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 39.06415557861328 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 15.351357460021973 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 14
Action Durations at step 2226: tensor([39.5731, 11.9245, 38.9651, 54.4758])
Traffic light set to phase 0 for 39.57306671142578 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 11.92454719543457 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 38.96505355834961 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 54.475830078125 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 15
Action Durations at step 2412: tensor([32.4579, 42.3326, 39.6608, 43.1902])
Traffic light set to phase 0 for 32.45792770385742 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 42.33258819580078 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 39.66083908081055 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 43.1901969909668 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 16
Action Durations at step 2612: tensor([ 7.3409, 18.8675, 16.2332, 53.6488])
Traffic light set to phase 0 for 7.340913772583008 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 18.867534637451172 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 16.233230590820312 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 53.648773193359375 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 17
Action Durations at step 2750: tensor([32.3772,  5.6698, 20.1277, 47.7134])
Traffic light set to phase 0 for 32.377166748046875 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 5.669796943664551 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 20.12770652770996 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 47.71341323852539 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 18
Action Durations at step 2898: tensor([31.7775, 33.7137, 15.7337, 51.4229])
Traffic light set to phase 0 for 31.7774658203125 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 33.71369171142578 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 15.73369026184082 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 51.42289352416992 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 19
Action Durations at step 3072: tensor([56.2599, 16.8131,  6.8676, 28.7392])
Traffic light set to phase 0 for 56.25993728637695 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 16.8131046295166 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 6.867556571960449 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 28.739158630371094 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 20
Action Durations at step 3222: tensor([31.7615, 47.2079, 36.3372, 41.9169])
Traffic light set to phase 0 for 31.761537551879883 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 47.20787811279297 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 36.33721160888672 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 41.91694259643555 seconds.
Traffic light set to phase 7 for 10 seconds.
Pushed to memory: state_shape=torch.Size([1, 3, 16, 100]), action_shape=torch.Size([4]), next_state_shape=torch.Size([1, 3, 16, 100]), reward_shape=torch.Size([1])
Total experiences in memory: 21
Action Durations at step 3421: tensor([50.6354, 12.0776, 56.1327, 45.5673])
Traffic light set to phase 0 for 50.63541793823242 seconds.
Traffic light set to phase 1 for 10 seconds.
Traffic light set to phase 2 for 12.077556610107422 seconds.
Traffic light set to phase 3 for 10 seconds.
Traffic light set to phase 4 for 56.132713317871094 seconds.
Traffic light set to phase 5 for 10 seconds.
Traffic light set to phase 6 for 45.56734848022461 seconds.
Traffic light set to phase 7 for 10 seconds.
epsilon : 1.000
queue length in epsiode 0 0.04851157662624035
Traceback (most recent call last):
  File "C:\Users\nks23\python310\traffic_signal_control\traffic_light_control\traffic_light_control_DQN-master\training_main.py", line 89, in <module>
    print(f'loss in epsiode {episode}',Simulation.loss_store[episode])
IndexError: list index out of range